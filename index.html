<!DOCTYPE html>
<html lang="ko">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9216314386092719" crossorigin="anonymous"></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í¬ë¦½í†  íŠ¸ë ˆì´ë” - ëª¨ì˜íˆ¬ì ì‹œë®¬ë ˆì´í„°</title>
<style>
:root{--bg:#0b0f19;--card:#111827;--border:#1e2a3a;--text:#e5e7eb;--muted:#6b7280;--buy:#ef4444;--sell:#3b82f6;--profit:#22c55e;--loss:#ef4444;--accent:#f59e0b;--sidebar:320px;}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'Segoe UI',-apple-system,BlinkMacSystemFont,'Noto Sans KR',sans-serif;min-height:100vh;font-size:15px;}

/* â”€â”€â”€ í—¤ë” â”€â”€â”€ */
header{display:flex;justify-content:space-between;align-items:center;padding:12px 28px;background:var(--card);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;}
.logo{font-size:22px;font-weight:800;background:linear-gradient(135deg,#f59e0b,#22c55e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.header-stats{display:flex;gap:28px;align-items:center;}
.stat{text-align:center;}
.stat-label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;}
.stat-val{font-size:19px;font-weight:700;}
.stat-val.profit{color:var(--profit);}
.stat-val.loss{color:var(--loss);}

/* â”€â”€â”€ ì–¸ì–´ í† ê¸€ â”€â”€â”€ */
.lang-toggle{display:flex;align-items:center;background:var(--card);border:1px solid var(--border);border-radius:20px;overflow:hidden;cursor:pointer;font-size:12px;font-weight:700;user-select:none;}
.lang-toggle span{padding:5px 10px;transition:all .2s;color:var(--muted);}
.lang-toggle span.active{background:var(--accent);color:#000;border-radius:18px;}

/* â”€â”€â”€ ì¹´ìš´íŠ¸ë‹¤ìš´ â”€â”€â”€ */
.timer-box{display:flex;flex-direction:column;align-items:center;background:linear-gradient(135deg,#1a1f2e,#0d1117);padding:10px 28px;border-radius:12px;min-width:120px;border:2px solid var(--accent);box-shadow:0 0 20px rgba(245,158,11,.15);}
.timer-label{font-size:11px;color:var(--accent);font-weight:600;letter-spacing:1px;text-transform:uppercase;}
.timer-val{font-size:52px;font-weight:900;color:var(--accent);font-variant-numeric:tabular-nums;line-height:1;text-shadow:0 0 20px rgba(245,158,11,.4);}
.timer-val.urgent{color:var(--loss);animation:blink .5s infinite;text-shadow:0 0 30px rgba(239,68,68,.6);}
@keyframes blink{50%{opacity:.3;}}
.turn-badge{font-size:13px;background:var(--accent);color:#000;padding:3px 10px;border-radius:4px;font-weight:700;}

/* â”€â”€â”€ ë©”ì¸ ë ˆì´ì•„ì›ƒ: ì‚¬ì´ë“œë°” + ì½”ì¸ ì˜ì—­ â”€â”€â”€ */
.main-layout{display:flex;gap:0;position:relative;}

/* â”€â”€â”€ ì™¼ìª½ ì‚¬ì´ë“œë°” (ê³ ì •) â”€â”€â”€ */
.sidebar{width:var(--sidebar);min-width:var(--sidebar);position:sticky;top:62px;height:calc(100vh - 62px);overflow-y:auto;background:#0d1117;border-right:1px solid var(--border);padding:16px;display:flex;flex-direction:column;gap:14px;z-index:50;}
.sidebar::-webkit-scrollbar{width:4px;}
.sidebar::-webkit-scrollbar-thumb{background:#1e2a3a;border-radius:2px;}

/* ì‚¬ì´ë“œë°” ì„¹ì…˜ ê³µí†µ */
.sb-section{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:14px;}
.sb-title{font-size:12px;font-weight:800;color:var(--accent);text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;display:flex;align-items:center;gap:6px;}

/* í„´ ê²Œì´ì§€ */
.turn-gauge{margin-bottom:4px;}
.turn-gauge-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;}
.turn-gauge-text{font-size:14px;font-weight:800;}
.turn-gauge-track{width:100%;height:14px;background:#1f2937;border-radius:7px;overflow:hidden;position:relative;}
.turn-gauge-fill{height:100%;border-radius:7px;transition:width .5s;background:linear-gradient(90deg,var(--accent),#eab308);}
.turn-gauge-fill.ending{background:linear-gradient(90deg,#ef4444,#f87171);}
.turn-gauge-marks{display:flex;justify-content:space-between;font-size:9px;color:#374151;margin-top:3px;}

/* ì†Œë“ìˆ˜ì¤€ */
.income-section .income-track{width:100%;height:12px;background:#1f2937;border-radius:6px;overflow:hidden;margin-bottom:4px;}
.income-section .income-fill{height:100%;border-radius:6px;transition:width .5s,background .5s;}
.income-section .income-info{display:flex;justify-content:space-between;align-items:center;}
.income-section .income-grade{font-size:14px;font-weight:800;}
.income-section .income-pct{font-size:12px;color:var(--muted);}
.income-ticks{display:flex;justify-content:space-between;font-size:8px;color:#374151;margin-top:2px;}

/* ë‰´ìŠ¤ íŒ¨ë„ (ì‚¬ì´ë“œë°” ë‚´) */
.news-card{background:#0d1117;border:1px solid var(--border);border-radius:8px;padding:10px;margin-bottom:8px;position:relative;overflow:hidden;transition:all .2s;}
.news-card:last-child{margin-bottom:0;}
.news-card:hover{border-color:#374151;}
.news-card.main-news{border-color:var(--accent);border-width:2px;background:linear-gradient(135deg,rgba(245,158,11,.06),#0d1117);}
.news-card.main-news .news-headline{font-size:15px;font-weight:800;line-height:1.4;}
.news-tag{display:inline-block;font-size:9px;font-weight:700;padding:2px 7px;border-radius:3px;margin-bottom:5px;text-transform:uppercase;letter-spacing:.5px;}
.news-tag.bullish{background:rgba(34,197,94,.15);color:#22c55e;border:1px solid rgba(34,197,94,.3);}
.news-tag.bearish{background:rgba(239,68,68,.15);color:#ef4444;border:1px solid rgba(239,68,68,.3);}
.news-tag.neutral{background:rgba(245,158,11,.15);color:#f59e0b;border:1px solid rgba(245,158,11,.3);}
.news-headline{font-size:13px;font-weight:700;line-height:1.3;margin-bottom:4px;}
.news-coin-name{color:#60a5fa;font-weight:800;}
.news-detail{font-size:11px;color:var(--muted);line-height:1.4;}
.news-coin-badge{display:inline-block;font-size:10px;font-weight:700;padding:2px 6px;border-radius:3px;background:rgba(255,255,255,.08);margin-top:4px;}
.news-impact{position:absolute;top:8px;right:8px;font-size:11px;font-weight:900;}
.news-impact.positive{color:var(--profit);}
.news-impact.negative{color:var(--loss);}
.sb-title::before{content:'';display:inline-block;width:8px;height:8px;background:var(--accent);border-radius:50%;animation:pulse-dot 1.5s infinite;}
@keyframes pulse-dot{0%,100%{opacity:1;}50%{opacity:.3;}}

/* â”€â”€â”€ ì˜¤ë¥¸ìª½ ì½”ì¸ ì˜ì—­ (2ì—´ ê·¸ë¦¬ë“œ) â”€â”€â”€ */
.coin-area{flex:1;padding:12px 16px 110px;overflow-y:auto;display:grid;grid-template-columns:1fr 1fr;gap:12px;align-content:start;}

/* ì½”ì¸ ì¹´ë“œ */
.coin-section{background:var(--card);border:1px solid var(--border);border-radius:10px;overflow:hidden;transition:border-color .3s;}
.coin-section.news-boost{border-color:rgba(34,197,94,.4);box-shadow:0 0 12px rgba(34,197,94,.1);}
.coin-section.news-crash{border-color:rgba(239,68,68,.4);box-shadow:0 0 12px rgba(239,68,68,.1);}
.coin-header{display:flex;align-items:center;padding:10px 12px;gap:10px;border-bottom:1px solid var(--border);}
.coin-icon{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:15px;color:#fff;flex-shrink:0;}
.coin-title{flex:1;min-width:0;}
.coin-name{font-size:15px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.coin-sym{font-size:12px;color:var(--muted);}
.coin-price-area{text-align:right;flex-shrink:0;}
.coin-price{font-size:19px;font-weight:700;font-variant-numeric:tabular-nums;}

/* ë“±ë½ë¥  ê°•ì¡° */
.coin-change{font-size:15px;font-weight:900;padding:3px 8px;border-radius:5px;display:inline-block;margin-top:2px;letter-spacing:.5px;}
.coin-change.up{color:#22c55e;background:rgba(34,197,94,.15);border:1px solid rgba(34,197,94,.3);text-shadow:0 0 8px rgba(34,197,94,.3);}
.coin-change.down{color:#ef4444;background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.3);text-shadow:0 0 8px rgba(239,68,68,.3);}
.coin-change.big-up{font-size:17px;color:#22c55e;background:rgba(34,197,94,.25);border:2px solid rgba(34,197,94,.5);text-shadow:0 0 12px rgba(34,197,94,.5);animation:glow-green 1s ease-in-out infinite alternate;}
.coin-change.big-down{font-size:17px;color:#ef4444;background:rgba(239,68,68,.25);border:2px solid rgba(239,68,68,.5);text-shadow:0 0 12px rgba(239,68,68,.5);animation:glow-red 1s ease-in-out infinite alternate;}
@keyframes glow-green{to{box-shadow:0 0 16px rgba(34,197,94,.4);}}
@keyframes glow-red{to{box-shadow:0 0 16px rgba(239,68,68,.4);}}

.coin-hold{text-align:right;min-width:0;padding-right:6px;flex-shrink:0;}
.coin-hold-label{font-size:10px;color:var(--muted);}
.coin-hold-qty{font-size:14px;font-weight:700;color:var(--accent);}
.coin-hold-val{font-size:11px;color:var(--muted);}

/* ì°¨íŠ¸ */
.chart-area{padding:6px 12px;height:110px;position:relative;}
.chart-area canvas{width:100%;height:100%;}

/* ì£¼ë¬¸ ë²„íŠ¼ â€” 2í–‰ ì»´íŒ©íŠ¸ */
.order-row{display:flex;align-items:center;padding:6px 8px;gap:3px;border-top:1px solid var(--border);background:#0d1117;flex-wrap:wrap;justify-content:center;}
.order-row::-webkit-scrollbar{height:0;}
.order-btn{padding:5px 2px;font-size:11px;font-weight:700;border:1px solid;border-radius:4px;cursor:pointer;transition:all .15s;text-align:center;min-width:38px;max-width:60px;flex:1;background:transparent;}
.order-btn:hover{transform:translateY(-1px);}
.order-btn:active{transform:translateY(0);}
.order-btn.sell{color:var(--sell);border-color:rgba(59,130,246,.3);}
.order-btn.sell:hover{background:rgba(59,130,246,.1);}
.order-btn.sell.active{background:rgba(59,130,246,.2);border-color:var(--sell);box-shadow:0 0 8px rgba(59,130,246,.3);}
.order-btn.buy{color:var(--buy);border-color:rgba(239,68,68,.3);}
.order-btn.buy:hover{background:rgba(239,68,68,.1);}
.order-btn.buy.active{background:rgba(239,68,68,.2);border-color:var(--buy);box-shadow:0 0 8px rgba(239,68,68,.3);}
.order-btn.all-sell{color:#fff;background:rgba(59,130,246,.2);border-color:var(--sell);font-weight:900;font-size:9px;}
.order-btn.all-sell:hover{background:rgba(59,130,246,.35);}
.order-btn.all-buy{color:#fff;background:rgba(239,68,68,.2);border-color:var(--buy);font-weight:900;font-size:9px;}
.order-btn.all-buy:hover{background:rgba(239,68,68,.35);}
.order-divider{width:2px;height:24px;background:var(--border);margin:0 2px;flex-shrink:0;}
.order-custom{padding:4px;font-size:11px;width:48px;background:#1a2332;border:1px solid var(--border);border-radius:4px;color:var(--text);text-align:center;flex-shrink:0;}
.order-custom:focus{outline:none;border-color:var(--accent);}
.order-pending{font-size:11px;font-weight:700;min-width:70px;text-align:center;padding:4px;border-radius:4px;flex-shrink:0;}
.order-pending.buy-pending{color:var(--buy);background:rgba(239,68,68,.08);}
.order-pending.sell-pending{color:var(--sell);background:rgba(59,130,246,.08);}

/* â”€â”€â”€ í•˜ë‹¨ ê³ ì •ë°” â”€â”€â”€ */
.bottom-bar{position:fixed;bottom:0;left:0;right:0;background:var(--card);border-top:1px solid var(--border);padding:12px 28px;display:flex;justify-content:space-between;align-items:center;z-index:100;gap:16px;}
.pending-summary{font-size:14px;color:var(--muted);flex:1;}
.pending-summary span{font-weight:700;}
.submit-btn{padding:14px 52px;font-size:17px;font-weight:800;color:#000;background:linear-gradient(135deg,#f59e0b,#eab308);border:none;border-radius:10px;cursor:pointer;transition:all .2s;white-space:nowrap;}
.submit-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(245,158,11,.4);}
.submit-btn:active{transform:translateY(0);}
.submit-btn:disabled{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none;}
.reset-btn{padding:10px 18px;font-size:14px;color:var(--muted);background:transparent;border:1px solid var(--border);border-radius:6px;cursor:pointer;}
.reset-btn:hover{background:#1a2332;}

/* â”€â”€â”€ ì˜¤ë²„ë ˆì´ â”€â”€â”€ */
#overlay{position:fixed;inset:0;background:rgba(10,14,23,.95);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:200;transition:opacity .4s;}
#overlay.hidden{opacity:0;pointer-events:none;}
#overlay h1{font-size:40px;font-weight:800;background:linear-gradient(135deg,#f59e0b,#22c55e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px;}
#overlay .desc{color:var(--muted);font-size:15px;text-align:center;max-width:520px;line-height:1.9;margin-bottom:22px;}
#overlay .start-btn{padding:16px 60px;font-size:18px;font-weight:800;color:#000;background:linear-gradient(135deg,#f59e0b,#eab308);border:none;border-radius:12px;cursor:pointer;transition:all .2s;}
#overlay .start-btn:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(245,158,11,.4);}
.result-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:28px;text-align:center;margin-bottom:18px;min-width:440px;max-width:560px;}
.result-title{font-size:36px;font-weight:800;margin-bottom:4px;}
.result-rank{font-size:56px;font-weight:900;margin:8px 0;line-height:1;}
.result-rank .pct{font-size:28px;vertical-align:super;}
.result-comment{font-size:16px;font-weight:600;margin:8px 0 14px;min-height:24px;}
.result-curve{margin:10px auto 14px;display:block;}
.result-stats{font-size:13px;color:var(--muted);line-height:2.0;}

/* ì‹œìŠ¤í…œ ë‰´ìŠ¤ (í•˜ë‹¨) */
.sys-news{position:fixed;bottom:68px;left:50%;transform:translateX(-50%);background:rgba(17,24,39,.95);border:1px solid var(--border);border-radius:6px;padding:8px 20px;font-size:13px;color:var(--accent);z-index:50;transition:opacity .5s;white-space:nowrap;max-width:700px;}
.sys-news.hidden{opacity:0;pointer-events:none;}

/* â”€â”€â”€ ì „ë©´ ê´‘ê³  ì¸í„°ìŠ¤í‹°ì…œ â”€â”€â”€ */
#ad-interstitial{position:fixed;inset:0;background:rgba(0,0,0,.92);z-index:500;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity .3s;}
#ad-interstitial.hidden{opacity:0;pointer-events:none;}
.ad-container{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:20px;text-align:center;max-width:480px;width:90%;}
.ad-label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;}
.ad-countdown{font-size:14px;color:var(--accent);margin-top:12px;font-weight:600;}
.ad-slot-box{min-height:250px;display:flex;align-items:center;justify-content:center;background:#0d1117;border-radius:8px;margin:8px 0;}

/* â”€â”€â”€ AdSense ì¸ê²Œì„ ë°°ë„ˆ â”€â”€â”€ */
.ad-banner{background:var(--card);border:1px solid var(--border);border-radius:8px;text-align:center;overflow:hidden;}
.ad-banner .ad-label{font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;padding:4px 0 2px;}
.ad-banner-sidebar{margin-top:auto;padding:8px;}
.ad-banner-sidebar .ad-slot-inline{min-height:250px;background:#0d1117;border-radius:6px;}
.ad-banner-top{display:none;}
.ad-banner-infeed{display:none;}

/* â”€â”€â”€ ëª¨ë°”ì¼ ì ‘ì´ì‹ ì£¼ë¬¸ â”€â”€â”€ */
.order-toggle{display:none;width:100%;padding:6px;font-size:11px;font-weight:700;color:var(--accent);background:#0d1117;border:none;border-top:1px solid var(--border);cursor:pointer;text-align:center;}
.order-row.collapsed{display:none !important;}

/* â”€â”€â”€ ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” í† ê¸€ â”€â”€â”€ */
.mobile-sidebar-toggle{display:none;}
.sidebar-overlay{display:none;}

@media(max-width:1200px){
  .sidebar{width:260px;min-width:260px;padding:12px;}
  .coin-area{padding:10px 10px 110px;gap:10px;}
}
@media(max-width:1000px){
  .sidebar{width:240px;min-width:240px;padding:10px;}
  .coin-area{grid-template-columns:1fr;padding:10px 10px 110px;gap:10px;}
}

/* â•â•â• ëª¨ë°”ì¼ ìµœì í™” (768px ì´í•˜) â•â•â• */
@media(max-width:768px){
  body{font-size:14px;-webkit-text-size-adjust:100%;}

  /* í—¤ë”: 2í–‰ ì»´íŒ©íŠ¸ */
  header{flex-wrap:wrap;padding:6px 10px;gap:4px;}
  .logo{font-size:16px;flex:1;}
  .header-stats{gap:6px;flex-wrap:wrap;justify-content:flex-end;}
  .stat{display:block!important;}
  .stat-label{font-size:8px;letter-spacing:0;}
  .stat-val{font-size:13px;}
  .timer-box{padding:4px 10px;min-width:60px;border-radius:6px;}
  .timer-label{font-size:8px;letter-spacing:.5px;}
  .timer-val{font-size:28px;text-shadow:0 0 12px rgba(245,158,11,.3);}
  .turn-badge{font-size:10px;padding:2px 6px;}

  /* ë©”ì¸: ì„¸ë¡œ ë ˆì´ì•„ì›ƒ */
  .main-layout{flex-direction:column;}

  /* ì‚¬ì´ë“œë°”: ìŠ¬ë¼ì´ë“œ ë“œë¡œì–´ */
  .sidebar{
    position:fixed;top:0;left:-100%;width:85vw;max-width:340px;min-width:auto;
    height:100vh;z-index:300;padding:14px;gap:12px;
    border-right:1px solid var(--border);border-bottom:none;
    transition:left .3s ease;overflow-y:auto;
  }
  .sidebar.open{left:0;}
  .sidebar-overlay{
    display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:250;
  }
  .sidebar-overlay.show{display:block;}
  .mobile-sidebar-toggle{
    display:flex;align-items:center;justify-content:center;
    position:fixed;bottom:54px;left:8px;z-index:100;
    width:40px;height:40px;border-radius:50%;
    background:var(--accent);color:#000;font-size:16px;font-weight:900;
    border:none;cursor:pointer;box-shadow:0 4px 12px rgba(245,158,11,.4);
  }

  /* â˜… ì½”ì¸ ì˜ì—­: 2ì—´ ê·¸ë¦¬ë“œë¡œ 8ê°œ ì¹´ë“œ í•œ í™”ë©´ì— */
  .coin-area{grid-template-columns:1fr 1fr;padding:4px 4px 60px;gap:4px;}

  /* â˜… ì½”ì¸ ì¹´ë“œ ì´ˆì†Œí˜•í™” */
  .coin-header{padding:4px 6px;gap:4px;}
  .coin-icon{width:22px;height:22px;font-size:10px;}
  .coin-title{min-width:0;}
  .coin-name{font-size:11px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
  .coin-sym{font-size:9px;}
  .coin-price{font-size:13px;}
  .coin-change{font-size:10px;padding:1px 4px;}
  .coin-change.big-up,.coin-change.big-down{font-size:11px;}
  .coin-hold{display:none;}
  .coin-price-area{text-align:right;}

  /* â˜… ì°¨íŠ¸ ì´ˆì†Œí˜• */
  .chart-area{height:48px;padding:2px 4px;}

  /* â˜… ì£¼ë¬¸ ë²„íŠ¼: ê¸°ë³¸ ìˆ¨ê¹€, íƒ­í•˜ë©´ ì—´ë¦¼ */
  .order-toggle{display:block;}
  .order-row{padding:4px 4px;gap:2px;flex-wrap:wrap;justify-content:center;}
  .order-btn{min-width:32px;max-width:44px;padding:6px 1px;font-size:9px;border-radius:4px;-webkit-tap-highlight-color:transparent;}
  .order-btn.all-sell,.order-btn.all-buy{font-size:8px;padding:5px 1px;}
  .order-divider{height:16px;margin:0 1px;}
  .order-custom{width:36px;padding:4px 1px;font-size:9px;}
  .order-pending{min-width:50px;font-size:9px;padding:3px 2px;}

  /* í•˜ë‹¨ë°” */
  .bottom-bar{padding:6px 8px;gap:6px;}
  .pending-summary{font-size:10px;}
  .submit-btn{padding:8px 14px;font-size:13px;border-radius:6px;}
  .reset-btn{padding:6px 10px;font-size:11px;}

  /* ì‹œìŠ¤í…œ ë‰´ìŠ¤ */
  .sys-news{bottom:48px;font-size:10px;padding:4px 10px;max-width:90vw;white-space:normal;text-align:center;}

  /* ì˜¤ë²„ë ˆì´/ê²°ê³¼ â€” ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ */
  #overlay{overflow-y:auto;padding:20px 16px;justify-content:flex-start;padding-top:10vh;}
  #overlay h1{font-size:28px;}
  #overlay .desc{font-size:13px;line-height:1.7;max-width:100%;margin-bottom:16px;padding:0 8px;}
  #overlay .start-btn{padding:14px 40px;font-size:16px;}
  .result-card{min-width:auto;max-width:100%;width:100%;padding:20px 16px;}
  .result-title{font-size:26px;}
  .result-title span{font-size:15px!important;}
  .result-rank{font-size:42px;}
  .result-rank .pct{font-size:22px;}
  .result-comment{font-size:14px;}
  .result-curve{width:100%!important;max-width:360px;}
  .result-stats{font-size:12px;line-height:1.8;}

  /* ì‚¬ì´ë“œë°” ë‚´ë¶€ ëª¨ë°”ì¼ ìµœì í™” */
  .sb-section{padding:10px;}
  .sb-title{font-size:11px;margin-bottom:8px;}
  .turn-gauge-text{font-size:13px;}
  .news-card{padding:8px;}
  .news-card.main-news .news-headline{font-size:14px;}
  .news-headline{font-size:12px;}
  .news-detail{font-size:10px;}

  /* ëª¨ë°”ì¼ ê´‘ê³ : ìƒë‹¨ ë°°ë„ˆ í‘œì‹œ, ì‚¬ì´ë“œë°” ê´‘ê³  ìˆ¨ê¹€ */
  .ad-banner-top{display:block;padding:4px;margin:0 4px 2px;}
  .ad-banner-top .ad-slot-inline{min-height:50px;background:#0d1117;border-radius:4px;}
  .ad-banner-sidebar{display:none;}
  .ad-banner-infeed{display:block;padding:4px;grid-column:1/-1;}
  .ad-banner-infeed .ad-slot-inline{min-height:50px;background:#0d1117;border-radius:4px;}
}

/* â•â•â• ë§¤ìš° ì‘ì€ í™”ë©´ (480px ì´í•˜) â•â•â• */
@media(max-width:480px){
  header{padding:4px 6px;}
  .logo{font-size:14px;}
  .lang-toggle span{padding:2px 6px;font-size:9px;}
  .header-stats{gap:4px;}
  .stat-label{font-size:7px;}
  .stat-val{font-size:11px;}
  .timer-box{padding:3px 8px;min-width:50px;}
  .timer-val{font-size:24px;}
  .coin-area{padding:3px 3px 56px;gap:3px;}
  .coin-header{padding:3px 5px;gap:3px;}
  .coin-icon{width:18px;height:18px;font-size:8px;}
  .coin-name{font-size:10px;}
  .coin-sym{font-size:8px;}
  .coin-price{font-size:11px;}
  .coin-change{font-size:9px;padding:1px 3px;}
  .chart-area{height:40px;padding:1px 3px;}
  .order-btn{min-width:28px;font-size:8px;padding:5px 1px;}
  .order-btn.all-sell,.order-btn.all-buy{font-size:7px;}
  .order-custom{width:32px;font-size:8px;}
  .order-pending{min-width:40px;font-size:8px;}
  .bottom-bar{padding:4px 6px;}
  .submit-btn{padding:7px 12px;font-size:12px;}
  .reset-btn{padding:5px 8px;font-size:10px;}
  .mobile-sidebar-toggle{width:34px;height:34px;font-size:14px;bottom:48px;left:4px;}
}

/* â•â•â• ë§¤ìš° ì‘ì€ ë†’ì´ (667px ì´í•˜, SE ë“±) â•â•â• */
@media(max-width:768px) and (max-height:667px){
  .chart-area{height:35px;}
  .coin-header{padding:2px 4px;gap:2px;}
  .coin-icon{width:16px;height:16px;font-size:7px;}
  .coin-name{font-size:9px;}
  .coin-price{font-size:10px;}
  .coin-change{font-size:8px;}
}
</style>
</head>
<body>

<header>
  <div class="logo" id="logo-text">í¬ë¦½í†  íŠ¸ë ˆì´ë”</div>
  <div class="header-stats">
    <div class="lang-toggle" id="lang-toggle" onclick="switchLang()">
      <span id="lang-ko" class="active">KO</span>
      <span id="lang-en">EN</span>
    </div>
    <div class="stat"><div class="stat-label">í˜„ê¸ˆ</div><div class="stat-val" id="s-cash">$1,000</div></div>
    <div class="stat"><div class="stat-label">ì½”ì¸ìì‚°</div><div class="stat-val" id="s-hold">$0</div></div>
    <div class="stat"><div class="stat-label">ì´ìì‚°</div><div class="stat-val" id="s-total">$1,000</div></div>
    <div class="stat"><div class="stat-label">ìˆ˜ìµë¥ </div><div class="stat-val" id="s-pnl">0.0%</div></div>
    <div class="timer-box" id="timer-box">
      <div class="timer-label">â± ë‚¨ì€ ì‹œê°„</div>
      <div class="timer-val" id="s-timer">60</div>
    </div>
  </div>
</header>

<div class="main-layout">
  <!-- â•â•â• ì™¼ìª½ ì‚¬ì´ë“œë°” (ê³ ì •) â•â•â• -->
  <aside class="sidebar">
    <!-- í„´ ê²Œì´ì§€ -->
    <div class="sb-section">
      <div class="sb-title">ğŸ“Š í„´ ì§„í–‰</div>
      <div class="turn-gauge">
        <div class="turn-gauge-row">
          <span class="turn-gauge-text" id="turn-text">í„´ 1 / 20</span>
          <span class="turn-badge" id="s-turn">1</span>
        </div>
        <div class="turn-gauge-track"><div class="turn-gauge-fill" id="turn-fill" style="width:5%;"></div></div>
        <div class="turn-gauge-marks"><span>1</span><span>5</span><span>10</span><span>15</span><span>20</span></div>
      </div>
    </div>

    <!-- ì†Œë“ìˆ˜ì¤€ -->
    <div class="sb-section income-section">
      <div class="sb-title">ğŸ’¼ ì†Œë“ìˆ˜ì¤€</div>
      <div class="income-track"><div class="income-fill" id="ig-fill" style="width:50%;background:#f59e0b;"></div></div>
      <div class="income-info">
        <span class="income-grade" id="ig-grade">ì¤‘ì‚°ì¸µ</span>
        <span class="income-pct" id="ig-pct">50%</span>
      </div>
      <div class="income-ticks"><span>ê·¹ë¹ˆ</span><span>ë¹ˆê³¤</span><span>ì €ì†Œë“</span><span>ì¤‘ì‚°</span><span>ê³ ì†Œë“</span><span>ìƒë¥˜</span><span>ìµœìƒë¥˜</span></div>
    </div>

    <!-- ë‰´ìŠ¤ -->
    <div class="sb-section">
      <div class="sb-title">ğŸ“° ì´ë²ˆ í„´ ì†ë³´</div>
      <div id="news-cards"></div>
    </div>

    <!-- ì‚¬ì´ë“œë°” í•˜ë‹¨ ê´‘ê³  (ë°ìŠ¤í¬í†±) -->
    <div class="ad-banner ad-banner-sidebar">
      <div class="ad-label">AD</div>
      <div class="ad-slot-inline">
        <ins class="adsbygoogle" style="display:block;width:100%;min-height:250px;" data-ad-client="ca-pub-9216314386092719" data-ad-slot="auto" data-ad-format="rectangle" data-full-width-responsive="false"></ins>
      </div>
    </div>
  </aside>

  <!-- ëª¨ë°”ì¼ ìƒë‹¨ ë°°ë„ˆ ê´‘ê³  -->
  <div class="ad-banner ad-banner-top">
    <div class="ad-label">AD</div>
    <div class="ad-slot-inline">
      <ins class="adsbygoogle" style="display:block;width:100%;min-height:50px;" data-ad-client="ca-pub-9216314386092719" data-ad-slot="auto" data-ad-format="horizontal" data-full-width-responsive="true"></ins>
    </div>
  </div>

  <!-- â•â•â• ì˜¤ë¥¸ìª½ ì½”ì¸ ì˜ì—­ â•â•â• -->
  <div class="coin-area" id="coin-container"></div>
</div>

<div class="bottom-bar">
  <div class="pending-summary" id="pending-summary">ì£¼ë¬¸ì„ ì„¤ì •í•˜ê³  ì œì¶œí•˜ì„¸ìš”.</div>
  <button class="reset-btn" onclick="resetOrders()">ì´ˆê¸°í™”</button>
  <button class="submit-btn" onclick="submitOrders()">ğŸ“Š ì£¼ë¬¸ ì œì¶œ â†’ ë‹¤ìŒ í„´</button>
</div>

<!-- ì „ë©´ ê´‘ê³  ì¸í„°ìŠ¤í‹°ì…œ -->
<div id="ad-interstitial" class="hidden">
  <div class="ad-container">
    <div class="ad-label">ê´‘ê³ </div>
    <div class="ad-slot-box">
      <ins class="adsbygoogle" style="display:block;width:100%;min-height:250px;" data-ad-client="ca-pub-9216314386092719" data-ad-slot="auto" data-ad-format="auto" data-full-width-responsive="true"></ins>
    </div>
    <div class="ad-countdown" id="ad-countdown">5ì´ˆ í›„ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤...</div>
  </div>
</div>

<div id="overlay">
  <h1>í¬ë¦½í†  íŠ¸ë ˆì´ë”</h1>
  <div class="desc">
    ëª¨ì˜íˆ¬ì ì‹œë®¬ë ˆì´í„°<br><br>
    â€¢ 8ê°œ ê°€ìƒ ì½”ì¸ ì°¨íŠ¸ë¥¼ ë³´ë©° <b>20í„´</b> ë™ì•ˆ íˆ¬ì<br>
    â€¢ ğŸ“° <b>ë§¤ í„´ ë‰´ìŠ¤ 3ê°œ</b>ê°€ ì‹œì„¸ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤<br>
    â€¢ ë‰´ìŠ¤ì˜ êµ°ì¤‘ì‹¬ë¦¬ë¥¼ ì½ê³  ë¹ ë¥´ê²Œ ëŒ€ì‘í•˜ì„¸ìš”!<br>
    â€¢ <b>ì „ì•¡ ë§¤ìˆ˜/ë§¤ë„</b>ë¡œ í•œ ë²ˆì— ì˜¬ì¸ ê°€ëŠ¥<br>
    â€¢ <b>ì œì¶œ ë²„íŠ¼</b>ì„ ëˆ„ë¥´ë©´ ì£¼ë¬¸ ì²´ê²° â†’ ë‹¤ìŒ í„´<br>
    â€¢ 1í„´ = 1ë¶„, ì‹œê°„ ë‚´ì— ì£¼ë¬¸ì„ ì™„ë£Œí•˜ì„¸ìš”<br>
    â€¢ ê°€ë§Œíˆ ìˆìœ¼ë©´ ì¸í”Œë ˆì´ì…˜ìœ¼ë¡œ í˜„ê¸ˆ ê°€ì¹˜ â†“<br>
    â€¢ ğŸ’€ ìƒì¥íì§€ ì½”ì¸ ì£¼ì˜!<br><br>
    <span style="color:var(--buy)">ë¹¨ê°• = ë§¤ìˆ˜</span> &nbsp;|&nbsp; <span style="color:var(--sell)">íŒŒë‘ = ë§¤ë„</span>
  </div>
  <div class="result-card" id="result-card" style="display:none;"></div>
  <button class="start-btn" id="start-btn">ê²Œì„ ì‹œì‘</button>
</div>

<!-- ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” í† ê¸€ -->
<button class="mobile-sidebar-toggle" id="sidebar-toggle" onclick="toggleSidebar()">ğŸ“°</button>
<div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>

<div class="sys-news hidden" id="sys-news"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// í¬ë¦½í†  íŠ¸ë ˆì´ë” v10 â€” ë‹¤êµ­ì–´ ì§€ì› + ì „ë©´ ê´‘ê³ 
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let lang='ko';

const T={
  ko:{
    logo:'í¬ë¦½í†  íŠ¸ë ˆì´ë”',cash:'í˜„ê¸ˆ',coinAsset:'ì½”ì¸ìì‚°',totalAsset:'ì´ìì‚°',pnl:'ìˆ˜ìµë¥ ',timeLeft:'â± ë‚¨ì€ ì‹œê°„',
    turnProgress:'ğŸ“Š í„´ ì§„í–‰',turnOf:'í„´',incomeLevel:'ğŸ’¼ ì†Œë“ìˆ˜ì¤€',newsTitle:'ğŸ“° ì´ë²ˆ í„´ ì†ë³´',
    bullish:'í˜¸ì¬',bearish:'ì•…ì¬',neutral:'í˜¼í•©',market:'ì „ì²´ ì‹œì¥',
    hold:'ë³´ìœ ',buyAll:'ì „ì•¡<br>ë§¤ìˆ˜',sellAll:'ì „ì•¡<br>ë§¤ë„',custom:'ì§ì ‘',
    pendingDefault:'ì£¼ë¬¸ì„ ì„¤ì •í•˜ê³  ì œì¶œí•˜ì„¸ìš”.',submit:'ğŸ“Š ì£¼ë¬¸ ì œì¶œ â†’ ë‹¤ìŒ í„´',reset:'ì´ˆê¸°í™”',
    orderReset:'ì£¼ë¬¸ ì´ˆê¸°í™”',noHold:'ë³´ìœ ë¶„ ì—†ìŒ',noTrade:'ê±°ë˜ë¶ˆê°€',overHold:'ì´ˆê³¼',noCash:'í˜„ê¸ˆ ë¶€ì¡±',cashShort:'í˜„ê¸ˆ($%s) ë¶€ì¡±',overSell:'ë³´ìœ ë¶„($%s) ì´ˆê³¼',
    buy:'ë§¤ìˆ˜',sell:'ë§¤ë„',pending:'ê±´',
    gameTitle:'í¬ë¦½í†  íŠ¸ë ˆì´ë”',gameDesc:`ëª¨ì˜íˆ¬ì ì‹œë®¬ë ˆì´í„°<br><br>â€¢ 8ê°œ ê°€ìƒ ì½”ì¸ ì°¨íŠ¸ë¥¼ ë³´ë©° <b>20í„´</b> ë™ì•ˆ íˆ¬ì<br>â€¢ ğŸ“° <b>ë§¤ í„´ ë‰´ìŠ¤ 3ê°œ</b>ê°€ ì‹œì„¸ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤<br>â€¢ ë‰´ìŠ¤ì˜ êµ°ì¤‘ì‹¬ë¦¬ë¥¼ ì½ê³  ë¹ ë¥´ê²Œ ëŒ€ì‘í•˜ì„¸ìš”!<br>â€¢ <b>ì „ì•¡ ë§¤ìˆ˜/ë§¤ë„</b>ë¡œ í•œ ë²ˆì— ì˜¬ì¸ ê°€ëŠ¥<br>â€¢ <b>ì œì¶œ ë²„íŠ¼</b>ì„ ëˆ„ë¥´ë©´ ì£¼ë¬¸ ì²´ê²° â†’ ë‹¤ìŒ í„´<br>â€¢ 1í„´ = 1ë¶„, ì‹œê°„ ë‚´ì— ì£¼ë¬¸ì„ ì™„ë£Œí•˜ì„¸ìš”<br>â€¢ ê°€ë§Œíˆ ìˆìœ¼ë©´ ì¸í”Œë ˆì´ì…˜ìœ¼ë¡œ í˜„ê¸ˆ ê°€ì¹˜ â†“<br>â€¢ ğŸ’€ ìƒì¥íì§€ ì½”ì¸ ì£¼ì˜!<br><br><span style="color:var(--buy)">ë¹¨ê°• = ë§¤ìˆ˜</span> &nbsp;|&nbsp; <span style="color:var(--sell)">íŒŒë‘ = ë§¤ë„</span>`,
    startBtn:'ê²Œì„ ì‹œì‘',restartBtn:'ë‹¤ì‹œ ì‹œì‘',
    bankrupt:'ğŸ’¸ íŒŒì‚°!',finished:'ğŸ ê²Œì„ ì¢…ë£Œ!',endTitle:'ê²Œì„ ì¢…ë£Œ',bankruptLabel:'íŒŒì‚°',
    topPct:'ìƒìœ„',finalAsset:'ìµœì¢… ìì‚°',cashLabel:'í˜„ê¸ˆ',coinLabel:'ì½”ì¸',totalTurn:'ì´',turnUnit:'í„´',inflAccum:'ì¸í”Œë ˆì´ì…˜ ëˆ„ì ',
    gameStart:'ğŸ® ê²Œì„ì‹œì‘! 20í„´ ì•ˆì— ìµœëŒ€ ìˆ˜ìµì„ ì˜¬ë¦¬ì„¸ìš”!',
    timeOver:'â° ì‹œê°„ì´ˆê³¼! ìë™ì œì¶œ',
    turnSummary:'âœ… í„´%t: ë§¤ìˆ˜$%b/ë§¤ë„$%s/ì¸í”Œë ˆ-$%i',turnNoOrder:'í„´%t: ì£¼ë¬¸ì—†ìŒ. ì¸í”Œë ˆ-$%i',
    scamNew:'âš ï¸ ì‹ ê·œ ìƒì¥: %n(%s) â€” ìŠ¤ìº  ì£¼ì˜!',delisted:'ğŸ’€ %s ìƒì¥íì§€!',
    adCountdown:'%sì´ˆ í›„ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤...',adLoading:'ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...',
    grades:['ê·¹ë¹ˆì¸µ','ë¹ˆê³¤ì¸µ','ì €ì†Œë“ì¸µ','ì¤‘ì‚°ì¸µ','ê³ ì†Œë“ì¸µ','ìƒë¥˜ì¸µ','ìµœìƒë¥˜ì¸µ'],
    gradeTicks:['ê·¹ë¹ˆ','ë¹ˆê³¤','ì €ì†Œë“','ì¤‘ì‚°','ê³ ì†Œë“','ìƒë¥˜','ìµœìƒë¥˜'],
    curveLow:'í•˜ìœ„',curveMid:'ì¤‘ê°„',curveHigh:'ìƒìœ„',curveMany:'ë§ìŒ',curveFew:'ì ìŒ',curveMe:'â–¼ ë‚˜'
  },
  en:{
    logo:'Crypto Trader',cash:'Cash',coinAsset:'Holdings',totalAsset:'Total',pnl:'P&L',timeLeft:'â± Time Left',
    turnProgress:'ğŸ“Š Turn Progress',turnOf:'Turn',incomeLevel:'ğŸ’¼ Income Level',newsTitle:'ğŸ“° Breaking News',
    bullish:'Bull',bearish:'Bear',neutral:'Mixed',market:'Whole Market',
    hold:'Hold',buyAll:'Buy<br>All',sellAll:'Sell<br>All',custom:'Custom',
    pendingDefault:'Set your orders and submit.',submit:'ğŸ“Š Submit â†’ Next Turn',reset:'Reset',
    orderReset:'Orders reset',noHold:'No holdings',noTrade:'Not tradable',overHold:'exceeds',noCash:'No cash',cashShort:'Cash($%s) short',overSell:'Holdings($%s) exceeded',
    buy:'Buy',sell:'Sell',pending:'orders',
    gameTitle:'Crypto Trader',gameDesc:`Trading Simulator<br><br>â€¢ Trade <b>8 virtual coins</b> over <b>20 turns</b><br>â€¢ ğŸ“° <b>3 news per turn</b> affect prices<br>â€¢ Read crowd sentiment & react fast!<br>â€¢ <b>Buy/Sell All</b> to go all-in<br>â€¢ Hit <b>Submit</b> to execute & go next<br>â€¢ 1 turn = 1 min, complete before time's up<br>â€¢ Idle cash loses value to inflation<br>â€¢ ğŸ’€ Watch out for delisted coins!<br><br><span style="color:var(--buy)">Red = Buy</span> &nbsp;|&nbsp; <span style="color:var(--sell)">Blue = Sell</span>`,
    startBtn:'Start Game',restartBtn:'Restart',
    bankrupt:'ğŸ’¸ Bankrupt!',finished:'ğŸ Game Over!',endTitle:'Game Over',bankruptLabel:'Bankrupt',
    topPct:'Top',finalAsset:'Final',cashLabel:'Cash',coinLabel:'Coins',totalTurn:'Total',turnUnit:'turns',inflAccum:'Inflation',
    gameStart:'ğŸ® Start! Maximize profits in 20 turns!',
    timeOver:'â° Time up! Auto-submit',
    turnSummary:'âœ… Turn%t: Buy$%b/Sell$%s/Infl-$%i',turnNoOrder:'Turn%t: No orders. Infl-$%i',
    scamNew:'âš ï¸ New listing: %n(%s) â€” Scam alert!',delisted:'ğŸ’€ %s delisted!',
    adCountdown:'Results in %s seconds...',adLoading:'Loading results...',
    grades:['Extreme Poverty','Poor','Low Income','Middle Class','Upper Middle','Upper Class','Elite'],
    gradeTicks:['Poor','Low','Mid-Low','Middle','Upper','Elite','Top'],
    curveLow:'Low',curveMid:'Mid',curveHigh:'Top',curveMany:'Many',curveFew:'Few',curveMe:'â–¼ Me'
  }
};

const NEWS_POOL_EN={
  bullish:[
    {headline:'{NAME} confirmed listing on 3 major exchanges',detail:'Global TOP3 exchange listing, volume surge expected',impact:.9,crowd:25},
    {headline:'"{SYM} ecosystem revolution" â€” Global corp partnership',detail:'Fortune 500 strategic alliance signed',impact:.85,crowd:20},
    {headline:'{NAME} mainnet upgrade success, 100x TPS boost',detail:'Processing speed dramatically improved',impact:.75,crowd:18},
    {headline:'Whale wallet spotted buying $5M more {SYM}',detail:'Major investor accumulating for 3 days straight',impact:.7,crowd:15},
    {headline:'{NAME} selected for gov blockchain project',detail:'Core tech adopted for public infrastructure',impact:.8,crowd:22},
    {headline:'Famous fund manager: "Buy {SYM} now or regret"',detail:'Wall Street legend gives strong buy signal',impact:.6,crowd:12},
    {headline:'{NAME} community surpasses 1 million',detail:'Daily active users surging, growth accelerating',impact:.5,crowd:10},
    {headline:'{SYM} DeFi protocol launch, TVL soaring',detail:'Innovative yield structure drawing massive liquidity',impact:.65,crowd:14},
    {headline:'Breaking: {NAME} ETF approval imminent',detail:'Regulatory insider: decision this month',impact:.95,crowd:28},
    {headline:'{SYM} halving D-30, supply squeeze anticipated',detail:'Historical avg 200% gain around halving',impact:.7,crowd:16},
  ],
  bearish:[
    {headline:'URGENT: {NAME} smart contract vulnerability found',detail:'Critical bug report published, hack risk',impact:.9,crowd:-25},
    {headline:'{SYM} core devs â€” 3 resign simultaneously',detail:'Internal conflict rumors, roadmap uncertain',impact:.8,crowd:-20},
    {headline:'Regulators launch full investigation on {NAME}',detail:'Money laundering probe officially opened',impact:.85,crowd:-22},
    {headline:'{SYM} whale dumps 70% of holdings',detail:'Top 10 wallets selling simultaneously',impact:.75,crowd:-18},
    {headline:'"{NAME} is a scam" â€” Famous analyst drops bomb',detail:'1M-follower influencer exposes tech flaws',impact:.65,crowd:-15},
    {headline:'{SYM} network down for 6 hours',detail:'Node operators leaving, transactions halted',impact:.8,crowd:-20},
    {headline:'{NAME} partner files for bankruptcy',detail:'Key partner Chapter 11, chain reaction feared',impact:.7,crowd:-16},
    {headline:'Major exchange considering {SYM} delisting',detail:'Volume crash and regulatory risk cited',impact:.85,crowd:-24},
    {headline:'{NAME} team token massive unlock',detail:'15% of total supply released, sell pressure',impact:.6,crowd:-12},
    {headline:'Global rate hike shock hits {SYM}',detail:'Emergency rate hike, risk assets plunge',impact:.7,crowd:-18},
  ],
  neutral:[
    {headline:'{NAME} unveils new roadmap... mixed reactions',detail:'Innovative but feasibility questioned',impact:.4,crowd:0},
    {headline:'Regulation talks â€” market cautious on {SYM}',detail:'Major nations discuss crypto framework',impact:.5,crowd:-5},
    {headline:'{SYM} volume spikes, big event ahead?',detail:'Unusual trading patterns, direction unclear',impact:.3,crowd:0},
    {headline:'Market sideways, all eyes on {NAME}',detail:'Bulls and bears deadlocked, breakout pending',impact:.2,crowd:0},
    {headline:'{NAME} founder: "We haven\'t even started"',detail:'Long-term vision emphasized, no short-term catalyst',impact:.35,crowd:3},
    {headline:'{SYM} vs rivals: tech comparison trending',detail:'Expert media deep dive, pros and cons each',impact:.25,crowd:0},
  ]
};

const MARKET_NEWS_POOL_EN={
  bullish:[
    {headline:'ğŸŒ Global institutions flood into crypto market',detail:'Pension funds allocating 5% to crypto',impact:.5,crowd:8},
    {headline:'ğŸ’° Crypto market cap hits all-time high',detail:'Bull market, new capital inflows accelerating',impact:.4,crowd:6},
    {headline:'ğŸ“± Big tech announces crypto payment integration',detail:'Real-world use cases expanding, optimism grows',impact:.45,crowd:7},
  ],
  bearish:[
    {headline:'ğŸ”» Fed emergency statement â€” tightening accelerates',detail:'Risk asset pressure, sentiment freezing',impact:.5,crowd:-8},
    {headline:'ğŸš¨ Major exchange hacked, market panic',detail:'Hundreds of millions drained, trust shattered',impact:.55,crowd:-10},
    {headline:'âš–ï¸ Major nations push total crypto ban',detail:'Mass exodus fears, panic spreading',impact:.5,crowd:-9},
  ]
};

const RANK_COMMENTS_EN={
1:'ğŸ† Legendary investor! You are the GOAT of crypto trading!',
2:'ğŸ‘‘ King of the market! Warren Buffett would ask YOU for tips.',
3:'ğŸŒŸ Genius instincts! Your trading journal belongs in textbooks.',
4:'ğŸ’ Ultimate diamond hands. Nerves of absolute steel.',
5:'ğŸ”¥ Legendary returns! Fund managers are lining up to recruit you.',
6:'ğŸ¦… Eagle-eyed market vision. Astonishing judgment!',
7:'âš¡ Lightning-fast timing! Better than most pro traders.',
8:'ğŸ¯ Every call was precise. You\'re a market sniper.',
9:'ğŸš€ Profits soaring like a rocket! Outstanding performance.',
10:'ğŸ’° Top 10%! Exceptional investment instincts.',
11:'ğŸ… Elite investor. Be proud of yourself.',
12:'ğŸ“ˆ Remarkable results! You can clearly read the market.',
13:'ğŸ–ï¸ Better returns than most fund managers. Impressive!',
14:'âœ¨ Shining track record! Real investing talent showing.',
15:'ğŸŒˆ Turned crisis into opportunity. A wise investor.',
16:'ğŸ¹ Master of timing! Buy and sell points were perfect.',
17:'ğŸ’ª Steel mentality conquered the volatility. Impressive!',
18:'ğŸ”® Great market prediction skills. A promising future!',
19:'ğŸª Survived the rollercoaster market brilliantly!',
20:'ğŸ“Š Top 20%! Pretty solid investment skills.',
21:'ğŸ€ Both luck and skill were on your side.',
22:'â­ Impressive gains! Worth bragging to your friends.',
23:'ğŸ¯ Good diversification and timing. Textbook strategy!',
24:'ğŸ”‘ You have the knack for spotting key opportunities.',
25:'ğŸ“± Go ahead and show off your portfolio on social media!',
26:'ğŸŒ¿ Steady growth with a healthy investment style.',
27:'ğŸ¢ Rode the waves like a surfer on the market!',
28:'ğŸ§­ Great sense of direction in your investments.',
29:'ğŸƒ Ahead of the majority â€” agile investor.',
30:'ğŸ‘ Top 30%! Well above average results.',
31:'ğŸ“˜ Solid fundamentals in your trading style.',
32:'ğŸŒ¤ï¸ A bright report card, like a sunny day.',
33:'ğŸµ Rhythmic trading! You caught the market\'s beat.',
34:'ğŸ§© Strategic investing, like solving a puzzle.',
35:'ğŸŒ± High growth potential! More experience will make you great.',
36:'ğŸˆ Decent results. Keep challenging yourself!',
37:'ğŸ”§ A little more refinement and you\'ll be excellent.',
38:'ğŸµ Stayed calm and steady. Good mental game.',
39:'ğŸŒŠ Kept your own pace without getting swept away.',
40:'ğŸ“— Not bad! Above average performance.',
41:'ğŸ­ Navigated the volatility reasonably well.',
42:'ğŸ§® Your calculated approach paid off to some extent.',
43:'ğŸŒ» Growing like a sunflower reaching for the sun!',
44:'ğŸ² Luck played a part. Next time, rely on skill!',
45:'ğŸ›¡ï¸ Defensive investing protected your assets well.',
46:'âš–ï¸ Tried to maintain a balanced portfolio.',
47:'ğŸƒ Swayed by the wind, but roots stayed firm.',
48:'ğŸ“ Conservative investing. Not losing big is a plus.',
49:'ğŸ£ Caught some bait, dodged some others.',
50:'ğŸ“Š Right in the middle! Half winning, half learning.',
51:'ğŸŒ¥ï¸ Cloudy results. Clearing up is possible.',
52:'ğŸ” Good analysis, but execution could improve.',
53:'ğŸª Held your own in the market circus.',
54:'ğŸ§Š Tried to stay cool but wavered at times.',
55:'ğŸ“¦ Conservative approach was a double-edged sword.',
56:'ğŸŒ§ï¸ Slightly disappointing. Read the news more carefully next time.',
57:'ğŸ¢ Turtle strategy... slow but was it safe?',
58:'ğŸ­ A lot of hesitation between buying and selling.',
59:'ğŸ§ª Some experimental trades, mixed results.',
60:'ğŸ“‰ Below average, but still okay. Experience is wealth!',
61:'ğŸŒ«ï¸ Investing felt like walking through fog.',
62:'ğŸ¯ Good aim, but the target kept moving.',
63:'ğŸ§© Strategy felt like a puzzle with missing pieces.',
64:'ğŸ‚ Assets fell gently like autumn leaves.',
65:'ğŸ“ Several turns need a review.',
66:'ğŸš¶ Walking slowly, drifted a bit from the goal.',
67:'ğŸŒ¬ï¸ Misread the wind direction a few times.',
68:'ğŸˆ Assets leaked slowly like a deflating balloon.',
69:'ğŸ”® Predictions were off more often than not.',
70:'ğŸ“Š Bottom 30%. Focus more on news analysis.',
71:'ğŸŒŠ Got swept by the waves a bit. Hold stronger next time!',
72:'ğŸ² Lady Luck wasn\'t on your side this time.',
73:'ğŸ§— The climb was tough, but not giving up is admirable.',
74:'ğŸŒ§ï¸ A rainy day for investing... needed an umbrella.',
75:'ğŸ“‰ Struggled in the downturn. Try hedging next time!',
76:'ğŸ­ Got caught up in crowd psychology a few times.',
77:'ğŸ§Š Lost composure at critical moments.',
78:'ğŸª If the market clowned you, you\'re not alone.',
79:'ğŸ“¦ Overall timing was unfortunate.',
80:'ğŸ’Š A bitter pill to swallow, but valuable lessons learned.',
81:'ğŸŒªï¸ The market tornado got you good this time.',
82:'ğŸ° More gambling than investing in some turns.',
83:'ğŸ§² Got attracted to all the wrong signals.',
84:'ğŸ“‰ Heavy losses. Time for a strategy overhaul.',
85:'ğŸŒ‹ Portfolio erupted... and not in a good way.',
86:'ğŸ­ FOMO took the wheel more than once.',
87:'ğŸ§Š Should have gone with your gut less often.',
88:'ğŸª The market played you. Happens to everyone.',
89:'ğŸ“¦ Almost nothing went right. Reverse strategy next time!',
90:'ğŸ˜° Bottom 10%... but hey, at least you didn\'t go bankrupt!',
91:'ğŸ° Some turns were more gamble than investment...',
92:'ğŸ“‰ Did you read the news backwards? Double check next time.',
93:'ğŸ§Š Slipped on ice kind of investing.',
94:'ğŸŒŠ Took a big wave head-on and got soaked.',
95:'ğŸ“¦ Almost every call was wrong. Inverse = #1!',
96:'ğŸ­ Did a scam coin get you? Check your portfolio...',
97:'ğŸ’¸ Assets melted away... inverse would\'ve been a jackpot.',
98:'ğŸš¨ Just released from investment prison.',
99:'ğŸ†˜ Someone send help to this investor!',
100:'ğŸ’€ Legendary losses... at this point it\'s almost a talent.'
};

const COIN_NAME_POOL=[
  {sym:'NOVA',name:'ë…¸ë°”ì½”ì¸',nameEn:'NovaCoin',color:'#e040fb'},{sym:'ZENX',name:'ì œë‹‰ìŠ¤',nameEn:'Zenix',color:'#7c4dff'},
  {sym:'BOLT',name:'ë³¼íŠ¸ì²´ì¸',nameEn:'BoltChain',color:'#ff6d00'},{sym:'LYNX',name:'ë§í¬ìŠ¤',nameEn:'Lynx',color:'#00e5ff'},
  {sym:'DUSK',name:'ë”ìŠ¤í¬',nameEn:'Dusk',color:'#546e7a'},{sym:'FLUX',name:'í”ŒëŸ­ìŠ¤',nameEn:'Flux',color:'#76ff03'},
  {sym:'ORCA',name:'ì˜¤ë¥´ì¹´',nameEn:'Orca',color:'#2979ff'},{sym:'PYRE',name:'íŒŒì´ì–´',nameEn:'Pyre',color:'#ff1744'},
  {sym:'IRIS',name:'ì•„ì´ë¦¬ìŠ¤',nameEn:'Iris',color:'#d500f9'},{sym:'KODA',name:'ì½”ë‹¤',nameEn:'Koda',color:'#00bfa5'},
  {sym:'RYZE',name:'ë¼ì´ì¦ˆ',nameEn:'Ryze',color:'#ffab00'},{sym:'VYNE',name:'ë°”ì¸',nameEn:'Vyne',color:'#69f0ae'},
  {sym:'APEX',name:'ì—ì´í™ìŠ¤',nameEn:'Apex',color:'#f50057'},{sym:'CUBE',name:'íë¸Œ',nameEn:'Cube',color:'#304ffe'},
  {sym:'ECHO',name:'ì—ì½”',nameEn:'Echo',color:'#18ffff'},{sym:'HALO',name:'í—¤ì¼ë¡œ',nameEn:'Halo',color:'#ffd600'},
  {sym:'JADE',name:'ì œì´ë“œ',nameEn:'Jade',color:'#00c853'},{sym:'MOON',name:'ë¬¸ì½”ì¸',nameEn:'MoonCoin',color:'#b388ff'},
  {sym:'NEON',name:'ë„¤ì˜¨',nameEn:'Neon',color:'#64ffda'},{sym:'ONYX',name:'ì˜¤ë‹‰ìŠ¤',nameEn:'Onyx',color:'#cfd8dc'},
  {sym:'PIXEL',name:'í”½ì…€',nameEn:'Pixel',color:'#ea80fc'},{sym:'QUASAR',name:'í€˜ì´ì‚¬',nameEn:'Quasar',color:'#40c4ff'},
];
const SCAM_NAME_POOL=[
  {sym:'RUGX',name:'ëŸ­í’€X',nameEn:'RugPullX',color:'#f5a623'},{sym:'PUMP',name:'íŒí”„ì‡',nameEn:'PumpIt',color:'#5fcfca'},
  {sym:'SCAM',name:'ìŠ¤ìºë¯¸',nameEn:'Scammy',color:'#e74c3c'},{sym:'EXIT',name:'ì—‘ì‹œíŠ¸ì½”ì¸',nameEn:'ExitCoin',color:'#ff6b6b'},
  {sym:'FAKE',name:'í˜ì´í¬ë¬¸',nameEn:'FakeMoon',color:'#ff9ff3'},
];

const NEWS_POOL={
  bullish:[
    {headline:'{NAME}, ëŒ€í˜• ê±°ë˜ì†Œ 3ê³³ ë™ì‹œ ìƒì¥ í™•ì •',detail:'ê¸€ë¡œë²Œ TOP3 ê±°ë˜ì†Œ ë™ì‹œ ìƒì¥, ê±°ë˜ëŸ‰ í­ì¦ ì˜ˆìƒ',impact:.9,crowd:25},
    {headline:'"{SYM} ìƒíƒœê³„ í˜ëª…" â€” ê¸€ë¡œë²Œ ê¸°ì—… íŒŒíŠ¸ë„ˆì‹­ ì²´ê²°',detail:'í¬ì¶˜500 ê¸°ì—…ê³¼ ì „ëµì  ì œíœ´',impact:.85,crowd:20},
    {headline:'{NAME} ë©”ì¸ë„· ì—…ê·¸ë ˆì´ë“œ ì„±ê³µ, TPS 100ë°° í–¥ìƒ',detail:'ì²˜ë¦¬ì†ë„ íšê¸°ì  ê°œì„ , ê°œë°œì í™˜í˜¸',impact:.75,crowd:18},
    {headline:'ê³ ë˜ ì§€ê°‘, {SYM} $500ë§Œ ì¶”ê°€ ë§¤ìˆ˜ í¬ì°©',detail:'ëŒ€í˜• íˆ¬ìì ì—°ì† 3ì¼ ë§¤ì§‘ ì¤‘',impact:.7,crowd:15},
    {headline:'{NAME}, ì •ë¶€ ë¸”ë¡ì²´ì¸ ì‚¬ì—… ìš°ì„ í˜‘ìƒ ëŒ€ìƒì ì„ ì •',detail:'ê³µê³µê¸°ê´€ ì¸í”„ë¼ êµ¬ì¶•ì— í•µì‹¬ ê¸°ìˆ  ì±„íƒ',impact:.8,crowd:22},
    {headline:'ìœ ëª… í€ë“œë§¤ë‹ˆì € "ì§€ê¸ˆ {SYM} ì•ˆ ì‚¬ë©´ í›„íšŒ"',detail:'ì›”ê°€ ì „ì„¤ì  íˆ¬ìì ê°•ë ¥ ë§¤ìˆ˜ ì¶”ì²œ',impact:.6,crowd:12},
    {headline:'{NAME} ì»¤ë®¤ë‹ˆí‹° 100ë§Œ ëŒíŒŒ',detail:'ì¼ì¼ í™œì„± ì‚¬ìš©ì ê¸‰ì¦, ì„±ì¥ì„¸ ê°€ì†í™”',impact:.5,crowd:10},
    {headline:'{SYM} ë””íŒŒì´ í”„ë¡œí† ì½œ ì¶œì‹œ, TVL ê¸‰ë“±',detail:'í˜ì‹ ì  ìˆ˜ìµë¥  êµ¬ì¡°ë¡œ ìœ ë™ì„± ëŒ€ê±° ìœ ì…',impact:.65,crowd:14},
    {headline:'ì†ë³´: {NAME} ETF ìŠ¹ì¸ ì„ë°•ì„¤ í™•ì‚°',detail:'ê·œì œ ë‹¹êµ­ ë‚´ë¶€ ì†Œì‹í†µ, ì´ë²ˆ ë‹¬ ë‚´ ê²°ì •',impact:.95,crowd:28},
    {headline:'{SYM} ë°˜ê°ê¸° D-30, ê³µê¸‰ ì¶•ì†Œ ê¸°ëŒ€ê°',detail:'ì—­ì‚¬ì  ë°˜ê°ê¸° ì „í›„ í‰ê·  200% ìƒìŠ¹',impact:.7,crowd:16},
  ],
  bearish:[
    {headline:'ê¸´ê¸‰: {NAME} ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì·¨ì•½ì  ë°œê²¬',detail:'ì¹˜ëª…ì  ë²„ê·¸ ë¦¬í¬íŠ¸ ê³µê°œ, í•´í‚¹ ìœ„í—˜',impact:.9,crowd:-25},
    {headline:'{SYM} í•µì‹¬ ê°œë°œì 3ëª… ë™ì‹œ í‡´ì‚¬',detail:'ë‚´ë¶€ ê°ˆë“±ì„¤ í™•ì‚°, ë¡œë“œë§µ ì´í–‰ ë¶ˆíˆ¬ëª…',impact:.8,crowd:-20},
    {headline:'ê·œì œ ë‹¹êµ­, {NAME} ê±°ë˜ ì „ë©´ ì¡°ì‚¬ ì°©ìˆ˜',detail:'ìê¸ˆì„¸íƒ ì˜í˜¹ìœ¼ë¡œ ê³µì‹ ì¡°ì‚¬ ê°œì‹œ',impact:.85,crowd:-22},
    {headline:'{SYM} ê³ ë˜ ì§€ê°‘, ë³´ìœ ë¶„ 70% ëŒ€ëŸ‰ ë§¤ë„',detail:'ìƒìœ„ 10ê°œ ì§€ê°‘ ë™ì‹œ ë§¤ë„ ì‹ í˜¸',impact:.75,crowd:-18},
    {headline:'"{NAME}ëŠ” ì‚¬ê¸°" â€” ìœ ëª… ë¶„ì„ê°€ í­íƒ„ ë°œì–¸',detail:'100ë§Œ íŒ”ë¡œì›Œ ì¸í”Œë£¨ì–¸ì„œ ê¸°ìˆ  ê²°í•¨ ë¶„ì„',impact:.65,crowd:-15},
    {headline:'{SYM} ë„¤íŠ¸ì›Œí¬ 6ì‹œê°„ì§¸ ë‹¤ìš´',detail:'ë…¸ë“œ ìš´ì˜ì ì´íƒˆ, íŠ¸ëœì­ì…˜ ì™„ì „ ì¤‘ë‹¨',impact:.8,crowd:-20},
    {headline:'{NAME} íŒŒíŠ¸ë„ˆì‚¬ íŒŒì‚° ì‹ ì²­',detail:'í•µì‹¬ í˜‘ë ¥ ê¸°ì—… Chapter 11, ì—°ì‡„ ì˜í–¥ ìš°ë ¤',impact:.7,crowd:-16},
    {headline:'ì£¼ìš” ê±°ë˜ì†Œ, {SYM} ìƒì¥ íì§€ ê²€í† ',detail:'ê±°ë˜ëŸ‰ ê¸‰ê°ê³¼ ê·œì œ ë¦¬ìŠ¤í¬ë¡œ í‡´ì¶œ ê°€ëŠ¥ì„±',impact:.85,crowd:-24},
    {headline:'{NAME} íŒ€ ë¬¼ëŸ‰ ëŒ€ê·œëª¨ ì–¸ë½',detail:'ì „ì²´ ê³µê¸‰ëŸ‰ 15% í•´ì œ, ë§¤ë„ ì••ë ¥ ì˜ˆìƒ',impact:.6,crowd:-12},
    {headline:'ê¸€ë¡œë²Œ ê¸ˆë¦¬ ì¸ìƒ ì‡¼í¬, {SYM} ì§ê²©íƒ„',detail:'ì—°ì¤€ ê¸´ê¸‰ ê¸ˆë¦¬ ì¸ìƒ, ìœ„í—˜ìì‚° ê¸‰ë½',impact:.7,crowd:-18},
  ],
  neutral:[
    {headline:'{NAME}, ì‹ ê·œ ë¡œë“œë§µ ë°œí‘œ... ë°˜ì‘ ì—‡ê°ˆë ¤',detail:'í˜ì‹ ì ì´ë‚˜ ì‹¤í˜„ ê°€ëŠ¥ì„± ì˜ë¬¸',impact:.4,crowd:0},
    {headline:'ê·œì œ ê°•í™” ë…¼ì˜ â€” {SYM} í¬í•¨ ì‹œì¥ ê²½ê³„',detail:'ì£¼ìš”êµ­ ì•”í˜¸í™”í ê·œì œ í”„ë ˆì„ì›Œí¬ ë…¼ì˜',impact:.5,crowd:-5},
    {headline:'{SYM} ê±°ë˜ëŸ‰ ê¸‰ë³€, ëŒ€í˜• ì´ë²¤íŠ¸ ì „ì¡°?',detail:'ë¹„ì •ìƒì  ê±°ë˜ íŒ¨í„´, ë°©í–¥ì„± ë¶ˆí™•ì‹¤',impact:.3,crowd:0},
    {headline:'ì‹œì¥ íš¡ë³´ì„¸, {NAME} í–¥ë°© ì£¼ëª©',detail:'ë§¤ìˆ˜Â·ë§¤ë„ ì„¸ë ¥ íŒ½íŒ½, ëŒíŒŒ ë°©í–¥ ê´€ì‹¬',impact:.2,crowd:0},
    {headline:'{NAME} ì°½ë¦½ì: "ì•„ì§ ì‹œì‘ë„ ì•ˆ í–ˆë‹¤"',detail:'ì¥ê¸° ë¹„ì „ ê°•ì¡°, ë‹¨ê¸° í˜¸ì¬ ë¶€ì¬',impact:.35,crowd:3},
    {headline:'{SYM} vs ê²½ìŸ ì½”ì¸, ê¸°ìˆ  ë¹„êµ í™”ì œ',detail:'ì „ë¬¸ ë§¤ì²´ ì‹¬ì¸µ ë¹„êµ, ê°ê° ì¥ë‹¨ì ',impact:.25,crowd:0},
  ]
};
const MARKET_NEWS_POOL={
  bullish:[
    {headline:'ğŸŒ ê¸€ë¡œë²Œ ê¸°ê´€íˆ¬ìì ì•”í˜¸í™”í ì‹œì¥ ëŒ€ê±° ì§„ì…',detail:'ì—°ê¸°ê¸ˆÂ·ë³´í—˜ì‚¬ í¬íŠ¸í´ë¦¬ì˜¤ 5% ë°°ë¶„',impact:.5,crowd:8},
    {headline:'ğŸ’° ì•”í˜¸í™”í ì‹œê°€ì´ì•¡ ì‚¬ìƒ ìµœê³ ì¹˜ ê°±ì‹ ',detail:'ì‹œì¥ í™œí™©, ì‹ ê·œ ìê¸ˆ ìœ ì… ê°€ì†',impact:.4,crowd:6},
    {headline:'ğŸ“± ë¹…í…Œí¬, ì•”í˜¸í™”í ê²°ì œ í†µí•© ë°œí‘œ',detail:'ì‹¤ìƒí™œ ì‚¬ìš© ì‚¬ë¡€ í™•ëŒ€, ë‚™ê´€ë¡ ',impact:.45,crowd:7},
  ],
  bearish:[
    {headline:'ğŸ”» ë¯¸ ì—°ì¤€ ê¸´ê¸‰ ì„±ëª… â€” ê¸´ì¶• ê°€ì†í™”',detail:'ìœ„í—˜ìì‚° í•˜ë½ ì••ë ¥, ì‹¬ë¦¬ ê¸‰ë­',impact:.5,crowd:-8},
    {headline:'ğŸš¨ ëŒ€í˜• ê±°ë˜ì†Œ í•´í‚¹, ì‹œì¥ íŒ¨ë‹‰',detail:'ìˆ˜ì–µ ë‹¬ëŸ¬ ìœ ì¶œ, ë³´ì•ˆ ì‹ ë¢° ì¶”ë½',impact:.55,crowd:-10},
    {headline:'âš–ï¸ ì£¼ìš”êµ­ ì•”í˜¸í™”í ì „ë©´ ê¸ˆì§€ë²• ì¶”ì§„',detail:'íˆ¬ìì ëŒ€ì´íƒˆ ìš°ë ¤, ê³µí¬ í™•ì‚°',impact:.5,crowd:-9},
  ]
};

let COINS=[],SCAM_POOL=[];
const START_CASH=1000,MAX_TURNS=20,TURN_TIME=60,INFLATION_PER_TURN=0.005;

let cash=START_CASH,holdings={},prices={},priceHist={},changes={},orders={};
let turn=0,timeLeft=TURN_TIME,timerInterval=null,gameRunning=false;
let income=50,inflTotal=0,delistedSet=new Set(),scamTimers={},activeScam=null;
let currentNews=[],newsEffects={};

function generateRandomCoins(){
  const s=[...COIN_NAME_POOL].sort(()=>Math.random()-.5);
  COINS=s.slice(0,8).map(c=>({...c,baseP:Math.round((5+Math.random()*55)*100)/100}));
  SCAM_POOL=[...SCAM_NAME_POOL].sort(()=>Math.random()-.5).slice(0,3);
}

// â•â•â• ë‹¤êµ­ì–´ í—¬í¼ â•â•â•
function t(key){return T[lang][key]||T['ko'][key]||key;}
function coinName(c){return lang==='en'?(c.nameEn||c.name):c.name;}

// â•â•â• ë‰´ìŠ¤ ìƒì„± â•â•â•
function generateNews(){
  currentNews=[];newsEffects={};
  const ac=COINS.filter(c=>!delistedSet.has(c.sym)&&!c.isScam);
  if(!ac.length)return;
  const used=new Set(),usedIdx=new Set();
  function pick(){const a=ac.filter(c=>!used.has(c.sym));const c=(a.length?a:ac)[Math.floor(Math.random()*(a.length||ac.length))];used.add(c.sym);return c;}
  function makeHL(raw,coin){
    const koName=coin?coin.name:'',enName=coin?(coin.nameEn||coin.name):'';
    const hs=(s,nm)=>s.replace(/{SYM}/g,coin?`<span class="news-coin-name">${coin.sym}</span>`:'').replace(/{NAME}/g,coin?`<span class="news-coin-name">${nm}</span>`:'');
    return{headlineKo:hs(raw.ko.headline,koName),detailKo:hs(raw.ko.detail,koName),headlineEn:hs(raw.en.headline,enName),detailEn:hs(raw.en.detail,enName)};
  }
  function pickN(poolKo,poolEn,coin){
    const l=poolKo.map((_,i)=>i).filter(i=>!usedIdx.has(i));
    const idx=l.length?l[Math.floor(Math.random()*l.length)]:Math.floor(Math.random()*poolKo.length);
    usedIdx.add(idx);
    const nKo=poolKo[idx],nEn=poolEn[idx];
    const hl=makeHL({ko:nKo,en:nEn},coin);
    return{...nKo,...hl};
  }
  const r=Math.random(),sent=r<.4?'bullish':r<.75?'bearish':'neutral';
  if(Math.random()<.3&&sent!=='neutral'){
    const pKo=MARKET_NEWS_POOL[sent],pEn=MARKET_NEWS_POOL_EN[sent];
    const idx=Math.floor(Math.random()*pKo.length);
    const hl=makeHL({ko:pKo[idx],en:pEn[idx]},null);
    currentNews.push({...pKo[idx],...hl,sentiment:sent,isMain:true,targetSym:'MARKET'});
    for(const c of ac)newsEffects[c.sym]=(newsEffects[c.sym]||0)+pKo[idx].crowd;
  }else{
    const coin=pick(),n=pickN(NEWS_POOL[sent],NEWS_POOL_EN[sent],coin);
    currentNews.push({...n,sentiment:sent,isMain:true,targetSym:coin.sym});
    newsEffects[coin.sym]=(newsEffects[coin.sym]||0)+n.crowd*(1+n.impact*.5);
    for(const c of ac)if(c.sym!==coin.sym)newsEffects[c.sym]=(newsEffects[c.sym]||0)+n.crowd*.15;
  }
  for(let i=0;i<2;i++){
    const coin=pick(),r2=Math.random(),s2=r2<.4?'bullish':r2<.7?'bearish':'neutral';
    const n=pickN(NEWS_POOL[s2],NEWS_POOL_EN[s2],coin);
    currentNews.push({...n,sentiment:s2,isMain:false,targetSym:coin.sym});
    newsEffects[coin.sym]=(newsEffects[coin.sym]||0)+n.crowd;
    for(const c of ac)if(c.sym!==coin.sym)newsEffects[c.sym]=(newsEffects[c.sym]||0)+n.crowd*.08;
  }
}

function renderNewsPanel(){
  const ct=document.getElementById('news-cards');
  ct.innerHTML='';
  if(!currentNews.length)return;
  currentNews.forEach((n,i)=>{
    const d=document.createElement('div');
    d.className='news-card';
    const tc=n.sentiment==='bullish'?'bullish':n.sentiment==='bearish'?'bearish':'neutral';
    const tt=t(n.sentiment);
    const it=n.crowd>0?`+${n.crowd.toFixed(0)}%`:n.crowd<0?`${n.crowd.toFixed(0)}%`:'Â±0%';
    const ic=n.crowd>0?'positive':n.crowd<0?'negative':'';
    const hl=lang==='en'?(n.headlineEn||n.headline):n.headlineKo||n.headline;
    const dt=lang==='en'?(n.detailEn||n.detail):n.detailKo||n.detail;
    d.innerHTML=`<span class="news-tag ${tc}">${tt}</span><div class="news-impact ${ic}">${it}</div><div class="news-headline">${hl}</div><div class="news-detail">${dt}</div><span class="news-coin-badge">${n.targetSym==='MARKET'?t('market'):n.targetSym}</span>`;
    ct.appendChild(d);
  });
}

// â•â•â• ì‹œì„¸ â•â•â•
function initPrices(){
  for(const c of COINS){
    if(c.isScam){prices[c.sym]=c.baseP;changes[c.sym]=Math.random()*20+5;priceHist[c.sym]=[c.baseP];continue;}
    prices[c.sym]=c.baseP;changes[c.sym]=Math.random()*10-5;priceHist[c.sym]=[c.baseP];
  }
}
function simulateNextTurn(){
  generateNews();
  for(const c of COINS){
    if(delistedSet.has(c.sym)){prices[c.sym]=0;changes[c.sym]=-100;continue;}
    const prev=prices[c.sym],trend=(changes[c.sym]||0)*.2,rnd=Math.random()*20-10;
    let base=trend+rnd*.8;
    let crowd=newsEffects[c.sym]||0;

    // â•â•â• ë‰´ìŠ¤ ë¶ˆì‹  ì•Œê³ ë¦¬ì¦˜ â•â•â•
    // 1) ë‰´ìŠ¤ ì‹ ë¢°ë„: ë‰´ìŠ¤ê°€ ì‹œì„¸ì— ì‹¤ì œ ë°˜ì˜ë˜ëŠ” ë¹„ìœ¨ (30~110%, ê°€ë” ê³¼ì‰/ë¶€ì¡±)
    const reliability=0.3+Math.random()*0.8;
    crowd*=reliability;

    // 2) ê°€ì§œ ë‰´ìŠ¤ / ì—­í–‰ ì´ë²¤íŠ¸: ë‰´ìŠ¤ì™€ ì •ë°˜ëŒ€ë¡œ ì›€ì§ì´ëŠ” í™•ë¥ 
    //    ì´ˆë°˜(1~5í„´) 35%, ì¤‘ë°˜(6~12í„´) 25%, í›„ë°˜(13~20í„´) 15%
    const fakeChance=turn<=5?0.35:turn<=12?0.25:0.15;
    if(Math.abs(crowd)>3&&Math.random()<fakeChance){
      crowd=-crowd*(0.5+Math.random()*0.7); // ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ 50~120% ì—­ì „
    }

    // 3) ì´ë¯¸ ë°˜ì˜ë¨(priced-in): í° í˜¸ì¬/ì•…ì¬ê°€ ë‚˜ì™”ì§€ë§Œ ì´ë¯¸ ê°€ê²©ì— ì„ ë°˜ì˜
    //    crowd ì ˆëŒ€ê°’ì´ í´ìˆ˜ë¡ priced-in í™•ë¥  ì¦ê°€
    if(Math.abs(crowd)>12&&Math.random()<0.30){
      crowd*=0.1+Math.random()*0.2; // ê¸°ëŒ€ì˜ 10~30%ë§Œ ì‹¤ì œ ë°˜ì˜
    }

    // 4) ë˜ëŒë¦¼(mean-reversion): ì§ì „ í„´ ë³€ë™ì´ ì»¸ìœ¼ë©´ ë°˜ëŒ€ë¡œ ë˜ëŒë¦¼
    const prevChange=changes[c.sym]||0;
    if(Math.abs(prevChange)>8){
      const reversion=-prevChange*(0.2+Math.random()*0.3);
      base+=reversion;
    }

    // 5) ëœë¤ ë…¸ì´ì¦ˆ ê°•í™”: ì‹œì¥ì˜ ë¹„í•©ë¦¬ì„±, ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ë³€ë™
    const chaos=(Math.random()-0.5)*8;

    const total=Math.max(-30,Math.min(35,base+crowd+chaos));
    const np=Math.max(.5,prev*(1+total/100));
    prices[c.sym]=np;changes[c.sym]=((np-prev)/prev)*100;
    priceHist[c.sym].push(np);if(priceHist[c.sym].length>30)priceHist[c.sym].shift();
  }
  for(const[sym]of Object.entries(scamTimers)){
    scamTimers[sym]--;
    if(scamTimers[sym]<=0&&!delistedSet.has(sym)){
      delistedSet.add(sym);prices[sym]=0;changes[sym]=-100;
      showSysNews(t('delisted').replace('%s',sym));
      if(holdings[sym]&&holdings[sym].qty>0)holdings[sym].qty=0;
    }
  }
  if(turn>3&&!activeScam&&Math.random()<.20){
    const sc=SCAM_POOL[Math.floor(Math.random()*SCAM_POOL.length)];
    activeScam={...sc,baseP:5+Math.random()*10,isScam:true};
    COINS.push(activeScam);prices[sc.sym]=activeScam.baseP;changes[sc.sym]=Math.random()*30+10;
    priceHist[sc.sym]=[activeScam.baseP];scamTimers[sc.sym]=2+Math.floor(Math.random()*3);
    showSysNews(t('scamNew').replace('%n',coinName(sc)).replace('%s',sc.sym));
  }
}

// â•â•â• UI â•â•â•
function buildCoinCards(){
  const ct=document.getElementById('coin-container');ct.innerHTML='';
  const totalAsset=getTotalAsset()||1;
  for(let idx=0;idx<COINS.length;idx++){const c=COINS[idx];
    const sym=c.sym,p=prices[sym]||c.baseP,ch=changes[sym]||0,isUp=ch>=0,isDead=delistedSet.has(sym);
    const h=holdings[sym],hQty=h?h.qty:0,hq=hQty*p;
    const holdRatio=hq/totalAsset*100;
    let cc=isUp?'up':'down';if(Math.abs(ch)>=10)cc=isUp?'big-up':'big-down';
    const crowd=newsEffects[sym]||0;let se='';
    if(crowd>=10)se=' news-boost';else if(crowd<=-10)se=' news-crash';
    const sec=document.createElement('div');sec.className='coin-section'+se;sec.id=`coin-${sym}`;
    if(isDead)sec.style.opacity='.4';
    // ë³´ìœ  ë¹„ì¤‘ë³„ í…Œë‘ë¦¬ ê°•ì¡°
    if(hq>0&&!isDead){const col=c.color;
      if(holdRatio>50){sec.style.border=`3px solid ${col}`;sec.style.boxShadow=`0 0 20px ${col}60, 0 0 40px ${col}30`;}
      else if(holdRatio>25){sec.style.border=`2px solid ${col}b3`;sec.style.boxShadow=`0 0 14px ${col}40`;}
      else if(holdRatio>10){sec.style.border=`2px solid ${col}80`;sec.style.boxShadow=`0 0 8px ${col}25`;}
      else{sec.style.border=`1px solid ${col}4d`;}
    }
    const isMobile=window.innerWidth<=768;
    const holdHtml=isMobile?'':`<div class="coin-hold"><div class="coin-hold-label">${t('hold')}</div><div class="coin-hold-qty">$${hq.toFixed(0)}</div><div class="coin-hold-val">${hQty.toFixed(4)} ${sym}</div></div>`;
    const pendingLabel=orders[sym]?(orders[sym]>0?`${t('buy')}$${orders[sym]}`:`${t('sell')}$${Math.abs(orders[sym])}`):'';
    const orderToggleText=isMobile?(pendingLabel||`â–¼ ${lang==='en'?'Trade':'ì£¼ë¬¸'}`):'';
    sec.innerHTML=`<div class="coin-header">
      <div class="coin-icon" style="background:${c.color}">${sym[0]}</div>
      <div class="coin-title"><div class="coin-name">${coinName(c)} ${c.isScam?'âš ï¸':''} ${isDead?'ğŸ’€':''}</div><div class="coin-sym">${sym}${isMobile&&hq>0?' Â· $'+hq.toFixed(0):''}</div></div>
      ${holdHtml}
      <div class="coin-price-area"><div class="coin-price">$${p.toFixed(2)}</div><div class="coin-change ${cc}">${isUp?'â–²':'â–¼'} ${Math.abs(ch).toFixed(2)}%</div></div>
    </div>
    <div class="chart-area"><canvas id="chart-${sym}"></canvas></div>
    <button class="order-toggle" id="toggle-${sym}" onclick="toggleOrder('${sym}')">${orderToggleText}</button>
    <div class="order-row${isMobile?' collapsed':''}" id="order-${sym}">
      <button class="order-btn all-sell sell" onclick="sellAll('${sym}',this)">${t('sellAll')}</button>
      <input class="order-custom" type="number" min="5" step="5" placeholder="${t('custom')}" id="cs-${sym}">
      <button class="order-btn sell" onclick="setOrder('${sym}',-50,this)">$50</button>
      <button class="order-btn sell" onclick="setOrder('${sym}',-30,this)">$30</button>
      <button class="order-btn sell" onclick="setOrder('${sym}',-10,this)">$10</button>
      <button class="order-btn sell" onclick="setOrder('${sym}',-5,this)">$5</button>
      <div class="order-divider"></div>
      <button class="order-btn buy" onclick="setOrder('${sym}',5,this)">$5</button>
      <button class="order-btn buy" onclick="setOrder('${sym}',10,this)">$10</button>
      <button class="order-btn buy" onclick="setOrder('${sym}',30,this)">$30</button>
      <button class="order-btn buy" onclick="setOrder('${sym}',50,this)">$50</button>
      <input class="order-custom" type="number" min="5" step="5" placeholder="${t('custom')}" id="cb-${sym}">
      <button class="order-btn all-buy buy" onclick="buyAll('${sym}',this)">${t('buyAll')}</button>
      <div class="order-pending" id="pending-${sym}"></div>
    </div>`;
    ct.appendChild(sec);
    // 4ë²ˆì§¸ ì¹´ë“œ ë’¤ì— ì¸í”¼ë“œ ê´‘ê³  ì‚½ì… (ëª¨ë°”ì¼)
    if(isMobile&&idx===3){
      const adDiv=document.createElement('div');adDiv.className='ad-banner ad-banner-infeed';
      adDiv.innerHTML='<div class="ad-label">AD</div><div class="ad-slot-inline"><ins class="adsbygoogle" style="display:block;width:100%;min-height:50px;" data-ad-client="ca-pub-9216314386092719" data-ad-slot="auto" data-ad-format="fluid" data-full-width-responsive="true"></ins></div>';
      ct.appendChild(adDiv);
      try{(adsbygoogle=window.adsbygoogle||[]).push({});}catch(e){}
    }
    document.getElementById(`cs-${sym}`).addEventListener('change',function(){const v=parseInt(this.value);if(v>0)setOrder(sym,-v,null);this.value='';});
    document.getElementById(`cb-${sym}`).addEventListener('change',function(){const v=parseInt(this.value);if(v>0)setOrder(sym,v,null);this.value='';});
  }
  drawAllCharts();
}
function drawAllCharts(){for(const c of COINS)drawChart(c.sym,c.color);}
function drawChart(sym,color){
  const cv=document.getElementById(`chart-${sym}`);if(!cv)return;
  const ctx=cv.getContext('2d'),rect=cv.parentElement.getBoundingClientRect();
  cv.width=rect.width;cv.height=rect.height;const w=cv.width,h=cv.height;
  ctx.clearRect(0,0,w,h);const hist=priceHist[sym]||[];if(hist.length<1)return;
  const mn=Math.min(...hist)*.98,mx=Math.max(...hist)*1.02,rng=mx-mn||1;
  ctx.strokeStyle='#1a2535';ctx.lineWidth=.5;
  for(let i=0;i<5;i++){const y=h*i/4;ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(w,y);ctx.stroke();}
  ctx.fillStyle='#374151';ctx.font='10px sans-serif';ctx.textAlign='right';
  for(let i=0;i<5;i++){const y=h*i/4;ctx.fillText('$'+(mx-(mx-mn)*i/4).toFixed(1),w-4,y+12);}
  if(hist.length<2)return;
  ctx.beginPath();
  for(let i=0;i<hist.length;i++){const x=i/(hist.length-1)*w,y=h-((hist[i]-mn)/rng)*h;i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);}
  ctx.lineTo(w,h);ctx.lineTo(0,h);ctx.closePath();
  const g=ctx.createLinearGradient(0,0,0,h);g.addColorStop(0,color+'30');g.addColorStop(1,color+'05');ctx.fillStyle=g;ctx.fill();
  ctx.beginPath();ctx.strokeStyle=color;ctx.lineWidth=2;
  for(let i=0;i<hist.length;i++){const x=i/(hist.length-1)*w,y=h-((hist[i]-mn)/rng)*h;i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);}
  ctx.stroke();
  const lx=w,ly=h-((hist[hist.length-1]-mn)/rng)*h;
  ctx.beginPath();ctx.arc(lx,ly,4,0,Math.PI*2);ctx.fillStyle=color;ctx.fill();
  ctx.beginPath();ctx.arc(lx,ly,6,0,Math.PI*2);ctx.strokeStyle=color+'60';ctx.lineWidth=2;ctx.stroke();
  if(hist.length>=2){const bw=Math.max(3,w/hist.length-2);
    for(let i=1;i<hist.length;i++){const x=i/(hist.length-1)*w-bw/2,o=hist[i-1],cl=hist[i];
      const lo=Math.min(o,cl),hi=Math.max(o,cl);
      ctx.fillStyle=cl>=o?'rgba(34,197,94,.25)':'rgba(239,68,68,.25)';
      ctx.fillRect(x,h-((hi-mn)/rng)*h,bw,Math.max(1,(h-((lo-mn)/rng)*h)-(h-((hi-mn)/rng)*h)));
    }
  }
}

// â•â•â• ì£¼ë¬¸ â•â•â•
function setOrder(sym,amt,btn){
  amt=parseInt(amt);if(delistedSet.has(sym)){showSysNews(`ğŸ’€ ${sym} ${t('noTrade')}`);return;}
  const cur=orders[sym]||0,nw=cur+amt;
  const p=prices[sym]||1;
  if(nw<0){const ha=holdings[sym]?holdings[sym].qty*p:0;if(Math.abs(nw)>ha+0.5){showSysNews(t('overSell').replace('%s',ha.toFixed(0)));return;}}
  if(nw>0){const tb=Object.values(orders).reduce((s,v)=>s+(v>0?v:0),0)-Math.max(0,cur)+Math.max(0,nw);if(tb>cash){showSysNews(t('cashShort').replace('%s',cash.toFixed(0)));return;}}
  orders[sym]=nw;updateOD(sym);updatePS();
  if(btn){btn.classList.add('active');setTimeout(()=>btn.classList.remove('active'),200);}
}
function sellAll(sym,btn){
  if(delistedSet.has(sym))return;const h=holdings[sym];const p=prices[sym]||1;
  if(!h||h.qty<=0){showSysNews(`${sym} ${t('noHold')}`);return;}
  const val=Math.floor(h.qty*p);
  orders[sym]=-val;updateOD(sym);updatePS();
  if(btn){btn.classList.add('active');setTimeout(()=>btn.classList.remove('active'),200);}
}
function buyAll(sym,btn){
  if(delistedSet.has(sym))return;
  const ob=Object.entries(orders).reduce((s,[k,v])=>k!==sym&&v>0?s+v:s,0),av=cash-ob;
  if(av<=0){showSysNews(t('noCash'));return;}
  orders[sym]=Math.floor(av);updateOD(sym);updatePS();
  if(btn){btn.classList.add('active');setTimeout(()=>btn.classList.remove('active'),200);}
}
function updateOD(sym){
  const el=document.getElementById(`pending-${sym}`),v=orders[sym]||0;
  if(!v){el.textContent='';el.className='order-pending';return;}
  if(v>0){el.textContent=`${t('buy')} $${v}`;el.className='order-pending buy-pending';}
  else{el.textContent=`${t('sell')} $${Math.abs(v)}`;el.className='order-pending sell-pending';}
  // ëª¨ë°”ì¼ í† ê¸€ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
  const tb=document.getElementById(`toggle-${sym}`);
  if(tb&&window.innerWidth<=768){
    const row=document.getElementById(`order-${sym}`);
    if(row&&row.classList.contains('collapsed')){
      tb.textContent=v?(v>0?`${t('buy')}$${v}`:`${t('sell')}$${Math.abs(v)}`):`â–¼ ${lang==='en'?'Trade':'ì£¼ë¬¸'}`;
      tb.style.color=v>0?'var(--buy)':v<0?'var(--sell)':'var(--accent)';
    }
  }
}
function updatePS(){
  let b=0,s=0,c=0;
  for(const[,v]of Object.entries(orders)){if(v>0){b+=v;c++;}else if(v<0){s+=Math.abs(v);c++;}}
  const el=document.getElementById('pending-summary');
  el.innerHTML=c===0?t('pendingDefault'):`<span>${c} ${t('pending')}</span> â€” <span style="color:var(--buy)">${t('buy')} $${b}</span> | <span style="color:var(--sell)">${t('sell')} $${s}</span>`;
}
function resetOrders(){orders={};for(const c of COINS)updateOD(c.sym);updatePS();showSysNews(t('orderReset'));}

// â•â•â• ì œì¶œ â•â•â•
function submitOrders(){
  if(!gameRunning)return;let bt=0,st=0;
  for(const[sym,amt]of Object.entries(orders)){
    if(!amt||delistedSet.has(sym))continue;const p=prices[sym];if(!p||p<=0)continue;
    if(amt>0){if(amt>cash)continue;cash-=amt;const coinQty=amt/p;if(!holdings[sym])holdings[sym]={qty:0,totalCost:0};
      holdings[sym].totalCost+=amt;holdings[sym].qty+=coinQty;bt+=amt;
    }else{const sa=Math.abs(amt),h=holdings[sym];if(!h)continue;const sellQty=sa/p;if(sellQty>h.qty*1.001)continue;
      const actualQty=Math.min(sellQty,h.qty);const actualAmt=actualQty*p;cash+=actualAmt;h.qty-=actualQty;st+=actualAmt;if(h.qty<0.0001)delete holdings[sym];}
  }
  const inf=cash*INFLATION_PER_TURN;cash=Math.max(0,cash-inf);inflTotal+=inf;
  updateIncome();
  orders={};turn++;
  // 20í„´ ì¢…ë£Œ ì²´í¬
  if(turn>MAX_TURNS){endGame('finished');return;}
  simulateNextTurn();
  for(const[sym,h]of Object.entries(holdings))if(delistedSet.has(sym))h.qty=0;
  if(getTotalAsset()<=0){endGame('bankrupt');return;}
  resetTimer();renderNewsPanel();buildCoinCards();updateHeader();updateTurnGauge();
  if(bt>0||st>0)showSysNews(t('turnSummary').replace('%t',turn).replace('%b',bt).replace('%s',st).replace('%i',inf.toFixed(1)));
  else showSysNews(t('turnNoOrder').replace('%t',turn).replace('%i',inf.toFixed(1)));
}

// â•â•â• ìì‚° â•â•â•
function getHV(){let v=0;for(const[sym,h]of Object.entries(holdings))if(h.qty>0&&!delistedSet.has(sym))v+=h.qty*(prices[sym]||0);return v;}
function getTotalAsset(){return cash+getHV();}

// â•â•â• ì†Œë“ìˆ˜ì¤€ (ìˆ˜ìµë¥  ê¸°ë°˜ ì‹¤ì‹œê°„) â•â•â•
// í˜„ì‹¤ ì†Œë“ë¶„ìœ„ ê¸°ë°˜: ìƒìœ„%â†’ì†Œë“ë“±ê¸‰
// ê·¹ë¹ˆì¸µ(í•˜ìœ„20%) | ë¹ˆê³¤ì¸µ(20~40%) | ì €ì†Œë“ì¸µ(40~60%) | ì¤‘ì‚°ì¸µ(60~80%) | ê³ ì†Œë“ì¸µ(80~90%) | ìƒë¥˜ì¸µ(90~99%) | ìµœìƒë¥˜ì¸µ(99~100%)
function updateIncome(){
  const tot=getTotalAsset(),pnl=(tot-START_CASH)/START_CASH*100;
  // ìƒìœ„ ëª‡ %ì¸ì§€ (1=ìµœê³ , 100=ìµœì €)
  const topPct=tot<=0?100:pnlToTopPercent(pnl);
  // ìƒìœ„% â†’ ê²Œì´ì§€ (ìƒìœ„1%=99, ìƒìœ„100%=0)
  income=Math.max(0,Math.min(100,100-topPct));
}

// â•â•â• í—¤ë” â•â•â•
function updateHeader(){
  const hv=getHV(),tot=getTotalAsset(),pp=(tot-START_CASH)/START_CASH*100;
  document.getElementById('s-cash').textContent='$'+cash.toFixed(0);
  document.getElementById('s-hold').textContent='$'+hv.toFixed(0);
  document.getElementById('s-total').textContent='$'+tot.toFixed(0);
  const pe=document.getElementById('s-pnl');
  pe.textContent=(pp>=0?'+':'')+pp.toFixed(1)+'%';pe.className='stat-val '+(pp>=0?'profit':'loss');
  // ì†Œë“ìˆ˜ì¤€ â€” í˜„ì‹¤ ì†Œë“ë¶„ìœ„ ê¸°ë°˜ ë“±ê¸‰
  const pct=Math.max(0,Math.min(100,income));
  document.getElementById('ig-fill').style.width=pct+'%';
  document.getElementById('ig-pct').textContent=Math.round(pct)+'%';
  const gr=t('grades');let col,label;
  // í˜„ì‹¤ ë¶„í¬: ê·¹ë¹ˆ(0~20) ë¹ˆê³¤(20~40) ì €ì†Œë“(40~60) ì¤‘ì‚°(60~80) ê³ ì†Œë“(80~90) ìƒë¥˜(90~99) ìµœìƒë¥˜(99~100)
  if(pct<20){col='#ef4444';label=gr[0];}
  else if(pct<40){col='#f87171';label=gr[1];}
  else if(pct<60){col='#fb923c';label=gr[2];}
  else if(pct<80){col='#f59e0b';label=gr[3];}
  else if(pct<90){col='#22c55e';label=gr[4];}
  else if(pct<99){col='#3b82f6';label=gr[5];}
  else{col='#a78bfa';label=gr[6];}
  document.getElementById('ig-fill').style.background=col;
  document.getElementById('ig-grade').textContent=label;document.getElementById('ig-grade').style.color=col;
}

// â•â•â• í„´ ê²Œì´ì§€ â•â•â•
function updateTurnGauge(){
  const pct=Math.min(100,turn/MAX_TURNS*100);
  document.getElementById('turn-text').textContent=`${t('turnOf')} ${turn} / ${MAX_TURNS}`;
  document.getElementById('s-turn').textContent=turn;
  const fill=document.getElementById('turn-fill');
  fill.style.width=pct+'%';
  fill.className='turn-gauge-fill'+(pct>=80?' ending':'');
}

// â•â•â• íƒ€ì´ë¨¸ â•â•â•
function resetTimer(){
  timeLeft=TURN_TIME;clearInterval(timerInterval);updateTimerDisplay();
  timerInterval=setInterval(()=>{if(!gameRunning)return;timeLeft--;updateTimerDisplay();
    if(timeLeft<=0){showSysNews(t('timeOver'));submitOrders();}
  },1000);
}
function updateTimerDisplay(){
  const el=document.getElementById('s-timer');el.textContent=timeLeft;
  const box=document.getElementById('timer-box');
  if(timeLeft<=10){el.className='timer-val urgent';box.style.borderColor='var(--loss)';box.style.boxShadow='0 0 30px rgba(239,68,68,.3)';}
  else if(timeLeft<=30){el.className='timer-val';el.style.color='#fb923c';box.style.borderColor='#fb923c';box.style.boxShadow='0 0 20px rgba(251,146,60,.2)';}
  else{el.className='timer-val';el.style.color='';box.style.borderColor='var(--accent)';box.style.boxShadow='0 0 20px rgba(245,158,11,.15)';}
}

// â•â•â• ì‹œì‘/ë â•â•â•
function startGame(){
  cash=START_CASH;holdings={};orders={};turn=1;income=50;inflTotal=0;
  delistedSet.clear();scamTimers={};activeScam=null;currentNews=[];newsEffects={};
  generateRandomCoins();gameRunning=true;initPrices();
  for(const c of COINS){const hist=[];let p=prices[c.sym];
    for(let i=0;i<15;i++){p=Math.max(1,p*(1+(Math.random()*.1-.05)));hist.push(p);}
    hist.push(prices[c.sym]);priceHist[c.sym]=hist;}
  generateNews();
  document.getElementById('overlay').classList.add('hidden');
  renderNewsPanel();buildCoinCards();updateHeader();updateTurnGauge();resetTimer();
  showSysNews(t('gameStart'));
  // ê´‘ê³  ì´ˆê¸°í™”
  try{document.querySelectorAll('.ad-banner ins.adsbygoogle').forEach(()=>{(adsbygoogle=window.adsbygoogle||[]).push({});});}catch(e){}
}
// â•â•â• ì‹¤ì œ íˆ¬ìì ìˆ˜ìµë¥  ë¶„í¬ ê¸°ë°˜ ìƒìœ„ % ê³„ì‚° â•â•â•
// ì‹¤ì œ í†µê³„: 60%ê°€ ì†ì‹¤, ìˆ˜ìµì ì¤‘ ê³¼ë°˜ì´ ì†Œì•¡, ì¢Œí¸í–¥ ë¶„í¬
// ìˆ˜ìµë¥  â†’ ìƒìœ„ % ë§¤í•‘ (ë³´ê°„ í…Œì´ë¸”)
// ì¶œì²˜: ìë³¸ì‹œì¥ì—°êµ¬ì›, NHíˆ¬ìì¦ê¶Œ/ì‹ í•œíˆ¬ìì¦ê¶Œ 2024-2025 ë¶„ì„
const REAL_DIST=[
  // [ìˆ˜ìµë¥ %, ìƒìœ„%] â€” ì‹¤ì œ íˆ¬ìì ë¶„í¬ ê¸°ë°˜ ë³´ê°„ì 
  [-80, 99], [-60, 95], [-50, 90], [-40, 85],
  [-30, 78], [-20, 70], [-15, 65], [-10, 60],
  [-5, 55],  [0, 48],   [5, 40],   [10, 33],
  [15, 27],  [20, 22],  [25, 18],  [30, 14],
  [40, 10],  [50, 7],   [60, 5],   [80, 3],
  [100, 2],  [150, 1]
];
function pnlToTopPercent(pnl){
  if(pnl<=REAL_DIST[0][0])return Math.min(100,REAL_DIST[0][1]+1);
  if(pnl>=REAL_DIST[REAL_DIST.length-1][0])return 1;
  for(let i=0;i<REAL_DIST.length-1;i++){
    const[p0,t0]=REAL_DIST[i],[p1,t1]=REAL_DIST[i+1];
    if(pnl>=p0&&pnl<p1){
      const ratio=(pnl-p0)/(p1-p0);
      return Math.max(1,Math.min(100,Math.round(t0+(t1-t0)*ratio)));
    }
  }
  return 50;
}

const RANK_COMMENTS={
1:'ğŸ† ì—­ì‚¬ì— ì´ë¦„ì„ ë‚¨ê¸¸ ì „ì„¤ì  íˆ¬ìì! ë‹¹ì‹ ì€ ì§„ì •í•œ ì‹ ì´ë‹¤.',
2:'ğŸ‘‘ ì‹œì¥ì˜ ì™•! ì›Œë Œ ë²„í•ì´ ë‹¹ì‹ ì—ê²Œ ì¡°ì–¸ì„ êµ¬í•  ë ˆë²¨.',
3:'ğŸŒŸ ì²œì¬ì  ì§ê°! ë‹¹ì‹ ì˜ ë§¤ë§¤ ì¼ì§€ëŠ” êµê³¼ì„œê°€ ë  ê²ƒì´ë‹¤.',
4:'ğŸ’ ë‹¤ì´ì•„ëª¬ë“œ í•¸ì¦ˆì˜ ëíŒì™•. í”ë“¤ë¦¼ ì—†ëŠ” ì² ì˜ ì‹¬ì¥.',
5:'ğŸ”¥ ì „ì„¤ì ì¸ ìˆ˜ìµë¥ ! í€ë“œë§¤ë‹ˆì €ë“¤ì´ ì¤„ ì„œì„œ ìŠ¤ì¹´ìš°íŠ¸í•  ê²ƒì´ë‹¤.',
6:'ğŸ¦… ë…ìˆ˜ë¦¬ì˜ ëˆˆìœ¼ë¡œ ì‹œì¥ì„ ê¿°ëš«ì—ˆë‹¤. ê²½ì´ë¡œìš´ íŒë‹¨ë ¥!',
7:'âš¡ ë²ˆê°œê°™ì€ ë§¤ë§¤ íƒ€ì´ë°! í”„ë¡œ íŠ¸ë ˆì´ë” ëº¨ì¹˜ëŠ” ì‹¤ë ¥.',
8:'ğŸ¯ ëª¨ë“  íŒë‹¨ì´ ì •í™•í–ˆë‹¤. ë‹¹ì‹ ì€ ì‹œì¥ì˜ ì €ê²©ìˆ˜.',
9:'ğŸš€ ë¡œì¼“ì²˜ëŸ¼ ì¹˜ì†Ÿì€ ìˆ˜ìµ! ëŒ€ë‹¨í•œ ì„±ê³¼ë¥¼ ê±°ë’€ë‹¤.',
10:'ğŸ’° ìƒìœ„ 10%! íƒì›”í•œ íˆ¬ì ê°ê°ì˜ ì†Œìœ ì.',
11:'ğŸ… ëˆ„ê°€ ë­ë˜ë„ ì—˜ë¦¬íŠ¸ íˆ¬ìì. ìë¶€ì‹¬ì„ ê°€ì ¸ë„ ì¢‹ë‹¤.',
12:'ğŸ“ˆ ë†€ë¼ìš´ ì„±ê³¼! ì‹œì¥ì„ ì½ëŠ” ëˆˆì´ í™•ì‹¤íˆ ìˆë‹¤.',
13:'ğŸ–ï¸ ëŒ€ë¶€ë¶„ì˜ í€ë“œë§¤ë‹ˆì €ë³´ë‹¤ ë‚˜ì€ ìˆ˜ìµë¥ . ëŒ€ë‹¨í•˜ë‹¤!',
14:'âœ¨ ë¹›ë‚˜ëŠ” ì‹¤ì ! íˆ¬ì ì¬ëŠ¥ì´ í™•ì‹¤íˆ ë³´ì¸ë‹¤.',
15:'ğŸŒˆ ìœ„ê¸°ë¥¼ ê¸°íšŒë¡œ ë°”ê¾¼ í˜„ëª…í•œ íˆ¬ìì.',
16:'ğŸ¹ ì •í™•í•œ íƒ€ì´ë°ì˜ ë‹¬ì¸! ë§¤ìˆ˜ ë§¤ë„ê°€ ì ˆë¬˜í–ˆë‹¤.',
17:'ğŸ’ª ê°•ì²  ë©˜íƒˆë¡œ ì‹œì¥ ë³€ë™ì„ ì´ê²¨ëƒˆë‹¤. ì¸ìƒì !',
18:'ğŸ”® ì‹œì¥ ì˜ˆì¸¡ë ¥ì´ ë›°ì–´ë‚˜ë‹¤. ë¯¸ë˜ê°€ ê¸°ëŒ€ë˜ëŠ” íˆ¬ìì.',
19:'ğŸª ë¡¤ëŸ¬ì½”ìŠ¤í„° ê°™ì€ ì‹œì¥ì—ì„œ í›Œë¥­íˆ ì‚´ì•„ë‚¨ì•˜ë‹¤!',
20:'ğŸ“Š ìƒìœ„ 20%! ê½¤ ê´œì°®ì€ íˆ¬ì ì‹¤ë ¥ì´ë‹¤.',
21:'ğŸ€ ìš´ê³¼ ì‹¤ë ¥ì´ ëª¨ë‘ ë”°ë¼ì¤€ ì¢‹ì€ ê²°ê³¼.',
22:'â­ ì¸ìƒì ì¸ ìˆ˜ìµ! ë™ë£Œë“¤ ì‚¬ì´ì—ì„œ ìë‘í•  ë§Œí•˜ë‹¤.',
23:'ğŸ¯ ì ì ˆí•œ ë¶„ì‚°íˆ¬ìì™€ íƒ€ì´ë°. êµê³¼ì„œì  ì „ëµ!',
24:'ğŸ”‘ í•µì‹¬ì„ ì§šëŠ” íˆ¬ì ê°ê°ì´ ìˆë‹¤.',
25:'ğŸ“± ë‹¹ì‹ ì˜ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ SNSì— ìë‘í•´ë„ ì¢‹ë‹¤.',
26:'ğŸŒ¿ ê¾¸ì¤€íˆ ì„±ì¥í•˜ëŠ” ê±´ì „í•œ íˆ¬ì ìŠ¤íƒ€ì¼.',
27:'ğŸ¢ íŒŒë„ë¥¼ íƒ„ ì„œí¼ì²˜ëŸ¼ ì‹œì¥ì„ ì¦ê²¼ë‹¤!',
28:'ğŸ§­ ë‚˜ì¹¨ë°˜ ê°™ì€ íˆ¬ì ë°©í–¥ ê°ê°ì„ ê°–ê³  ìˆë‹¤.',
29:'ğŸƒ ëŒ€ë‹¤ìˆ˜ë³´ë‹¤ ì•ì„œ ë‚˜ê°€ëŠ” ë¯¼ì²©í•œ íˆ¬ìì.',
30:'ğŸ‘ ìƒìœ„ 30%! í‰ê· ì„ í›Œì© ë„˜ëŠ” ì¢‹ì€ ê²°ê³¼.',
31:'ğŸ“˜ ê¸°ë³¸ê¸°ê°€ íƒ„íƒ„í•œ íˆ¬ì ìŠ¤íƒ€ì¼ì´ ë³´ì¸ë‹¤.',
32:'ğŸŒ¤ï¸ ë§‘ì€ ë‚ ì”¨ì²˜ëŸ¼ ë°ì€ ì„±ì í‘œ.',
33:'ğŸµ ë¦¬ë“¬ê° ìˆëŠ” ë§¤ë§¤! ì‹œì¥ì˜ ë°•ìë¥¼ ì½ì—ˆë‹¤.',
34:'ğŸ§© í¼ì¦ ì¡°ê°ì„ ë§ì¶”ë“¯ ì „ëµì ì¸ íˆ¬ìë¥¼ í–ˆë‹¤.',
35:'ğŸŒ± ì„±ì¥ ê°€ëŠ¥ì„±ì´ í° íˆ¬ìì! ê²½í—˜ì´ ìŒ“ì´ë©´ ë” ì¢‹ì•„ì§ˆ ê²ƒ.',
36:'ğŸˆ ë¬´ë‚œí•˜ë©´ì„œë„ ë‚˜ì˜ì§€ ì•Šì€ ê²°ê³¼. ê³„ì† ë„ì „í•˜ì!',
37:'ğŸ”§ ì¡°ê¸ˆë§Œ ë” ë‹¤ë“¬ìœ¼ë©´ í›Œë¥­í•œ íˆ¬ììê°€ ë  ìˆ˜ ìˆë‹¤.',
38:'ğŸµ ì°¨ë¶„í•˜ê²Œ ì˜ ë²„í…¼ë‹¤. ë©˜íƒˆ ê´€ë¦¬ê°€ ì¢‹ë‹¤.',
39:'ğŸŒŠ íŒŒë„ì— íœ©ì“¸ë¦¬ì§€ ì•Šê³  ìê¸° í˜ì´ìŠ¤ë¥¼ ìœ ì§€í–ˆë‹¤.',
40:'ğŸ“— ë‚˜ì˜ì§€ ì•Šë‹¤! í‰ê·  ì´ìƒì˜ ì„±ê³¼.',
41:'ğŸ­ ë³€ë™ì„± ì†ì—ì„œ ë‚˜ë¦„ëŒ€ë¡œ ì˜ í•´ëƒˆë‹¤.',
42:'ğŸ§® ê³„ì‚°ì ì¸ ì ‘ê·¼ì´ ì–´ëŠ ì •ë„ íš¨ê³¼ë¥¼ ë´¤ë‹¤.',
43:'ğŸŒ» í–‡ë³• ì•„ë˜ í”¼ì–´ë‚˜ëŠ” í•´ë°”ë¼ê¸°ì²˜ëŸ¼, ì„±ì¥ ì¤‘!',
44:'ğŸ² ì•½ê°„ì˜ ìš´ì´ ë”°ë¼ì¤€ ê²°ê³¼. ë‹¤ìŒì—” ì‹¤ë ¥ìœ¼ë¡œ!',
45:'ğŸ›¡ï¸ ë°©ì–´ì  íˆ¬ìë¡œ ìì‚°ì„ ì˜ ì§€ì¼°ë‹¤.',
46:'âš–ï¸ ê· í˜• ì¡íŒ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ìœ ì§€í•˜ë ¤ ë…¸ë ¥í•œ í”ì .',
47:'ğŸƒ ë°”ëŒì— í”ë“¤ë ¤ë„ ë¿Œë¦¬ëŠ” ë‹¨ë‹¨í–ˆë‹¤.',
48:'ğŸ“ ì •ì„ì ì¸ íˆ¬ì. í¬ê²Œ ìƒì§€ ì•Šì€ ê²ƒì´ ì¥ì .',
49:'ğŸ£ ë¯¸ë¼ë¥¼ ë¬¼ê¸°ë„ í•˜ê³ , í”¼í•˜ê¸°ë„ í–ˆë‹¤.',
50:'ğŸ“Š ì •í™•íˆ ì¤‘ê°„! ë°˜ì€ ì´ê¸°ê³  ë°˜ì€ ë°°ìš°ëŠ” ì¤‘.',
51:'ğŸŒ¥ï¸ íë¦° ë‚ ì”¨ ê°™ì€ ì„±ì . ë§‘ì•„ì§ˆ ê°€ëŠ¥ì„±ì€ ìˆë‹¤.',
52:'ğŸ” ë¶„ì„ì€ í–ˆìœ¼ë‚˜ ì‹¤í–‰ì´ ì•„ì‰¬ì› ë˜ í„´ë“¤ì´ ìˆë‹¤.',
53:'ğŸª ì‹œì¥ì´ë¼ëŠ” ì„œì»¤ìŠ¤ì—ì„œ ë‚˜ë¦„ ë²„í…¼ë‹¤.',
54:'ğŸ§Š ëƒ‰ì •í•¨ì„ ìœ ì§€í•˜ë ¤ í–ˆìœ¼ë‚˜ ê°€ë” í”ë“¤ë ¸ë‹¤.',
55:'ğŸ“¦ ë³´ìˆ˜ì ì¸ íˆ¬ìê°€ ì–‘ë‚ ì˜ ê²€ì´ ë˜ì—ˆë‹¤.',
56:'ğŸŒ§ï¸ ì•½ê°„ ì•„ì‰¬ìš´ ê²°ê³¼. ë‹¤ìŒì—” ë‰´ìŠ¤ë¥¼ ë” ì˜ ì½ì–´ë³´ì.',
57:'ğŸ¢ ê±°ë¶ì´ ì „ëµ... ëŠë¦¬ì§€ë§Œ ì•ˆì „í–ˆì„ê¹Œ?',
58:'ğŸ­ ë§¤ìˆ˜ì™€ ë§¤ë„ ì‚¬ì´ì—ì„œ ë§ì´ ê³ ë¯¼í•œ í”ì ì´ ë³´ì¸ë‹¤.',
59:'ğŸ§ª ì‹¤í—˜ì ì¸ íˆ¬ìë¥¼ ëª‡ ë²ˆ í–ˆëŠ”ë°, ê²°ê³¼ëŠ” ì• ë§¤.',
60:'ğŸ“‰ í‰ê·  ì´í•˜ì§€ë§Œ ì•„ì§ ê´œì°®ë‹¤. ê²½í—˜ì´ ì¬ì‚°!',
61:'ğŸŒ«ï¸ ì•ˆê°œ ì†ì„ ê±·ëŠ” ë“¯í•œ íˆ¬ìì˜€ë‹¤.',
62:'ğŸ¯ ëª©í‘œëŠ” ì¢‹ì•˜ìœ¼ë‚˜ ê³¼ë…ì´ ìê¾¸ ì›€ì§ì˜€ë‹¤.',
63:'ğŸ§© í¼ì¦ì˜ ëª‡ ì¡°ê°ì´ ë¹ ì§„ ëŠë‚Œì˜ ì „ëµ.',
64:'ğŸ‚ ê°€ì„ ë‚™ì—½ì²˜ëŸ¼ ìì‚°ì´ ì‚´ì§ ë–¨ì–´ì¡Œë‹¤.',
65:'ğŸ“ ë³µê¸°ê°€ í•„ìš”í•œ í„´ì´ ê½¤ ìˆì—ˆë‹¤.',
66:'ğŸš¶ ì²œì²œíˆ ê±·ë‹¤ ë³´ë‹ˆ ëª©ì ì§€ì—ì„œ ì¢€ ë©€ì–´ì¡Œë‹¤.',
67:'ğŸŒ¬ï¸ ë°”ëŒì˜ ë°©í–¥ì„ ì˜ëª» ì½ì€ í„´ì´ ëª‡ ë²ˆ ìˆì—ˆë‹¤.',
68:'ğŸˆ í’ì„ ì´ ìƒˆëŠ” ê²ƒì²˜ëŸ¼ ì¡°ê¸ˆì”© ë¹ ì ¸ë‚˜ê°”ë‹¤.',
69:'ğŸ”® ì˜ˆì¸¡ì´ ë¹—ë‚˜ê°„ íšŸìˆ˜ê°€ ì¢€ ë§ì•˜ë‹¤.',
70:'ğŸ“Š í•˜ìœ„ 30%. ë‰´ìŠ¤ ë¶„ì„ì— ë” ì§‘ì¤‘í•´ë³´ì.',
71:'ğŸŒŠ íŒŒë„ì— ì¢€ íœ©ì“¸ë¦° ëŠë‚Œ. ë‹¤ìŒì—” ë²„í…¨ë³´ì!',
72:'ğŸ² ìš´ì´ ë”°ë¼ì£¼ì§€ ì•Šì•˜ë‹¤. íƒ“í•  ê±´ í•˜ëŠ˜ë¿.',
73:'ğŸ§— ì˜¤ë¥´ë§‰ì´ í˜ë“¤ì—ˆì§€ë§Œ í¬ê¸°í•˜ì§€ ì•Šì€ ê±´ ëŒ€ë‹¨í•˜ë‹¤.',
74:'ğŸŒ§ï¸ ë¹„ ì˜¤ëŠ” ë‚ ì˜ íˆ¬ì... ìš°ì‚°ì´ í•„ìš”í–ˆë‹¤.',
75:'ğŸ“‰ í•˜ë½ì¥ì— ê³ ì „í–ˆë‹¤. ë‹¤ìŒì—” í—¤ì§€ ì „ëµì„!',
76:'ğŸ­ êµ°ì¤‘ì‹¬ë¦¬ì— ëª‡ ë²ˆ íœ©ì“¸ë¦° ê²ƒ ê°™ë‹¤.',
77:'ğŸ§Š ëƒ‰ì •í•¨ì„ ìƒì€ ìˆœê°„ë“¤ì´ ê²°ê³¼ì— ì˜í–¥ì„ ì¤¬ë‹¤.',
78:'ğŸª ì‹œì¥ì˜ ê´‘ëŒ€ì—ê²Œ ë‹¹í•œ ëŠë‚Œì´ ë“ ë‹¤ë©´, ë‹¹ì‹ ë§Œ ê·¸ëŸ° ê²Œ ì•„ë‹ˆë‹¤.',
79:'ğŸ“¦ íƒ€ì´ë°ì´ ì „ë°˜ì ìœ¼ë¡œ ì•„ì‰¬ì› ë‹¤.',
80:'ğŸ˜“ ìƒìœ„ 80%... ìˆ˜ì—…ë£Œë¼ê³  ìƒê°í•˜ì.',
81:'ğŸŒªï¸ í­í’ ê°™ì€ ì‹œì¥ì—ì„œ ë§ì´ í”ë“¤ë ¸ë‹¤.',
82:'ğŸ“ ì‹¤ìˆ˜ì—ì„œ ë°°ìš°ëŠ” ê²ƒì´ ì§„ì§œ íˆ¬ì ê³µë¶€ë‹¤.',
83:'ğŸ¢ ë¡¤ëŸ¬ì½”ìŠ¤í„°ë¥¼ íƒ€ë‹¤ ë©€ë¯¸ê°€ ì¢€ ë‚¬ì„ ê²ƒ ê°™ë‹¤.',
84:'ğŸ§® ê³„ì‚°ì´ ìê¾¸ ì–´ê¸‹ë‚¬ë‹¤. ì—°ìŠµì´ ë” í•„ìš”í•˜ë‹¤.',
85:'ğŸŒ‘ ì–´ë‘ìš´ í„°ë„ì´ì—ˆì§€ë§Œ ëì€ ìˆë‹¤!',
86:'ğŸ£ ë¬¼ê³ ê¸°ëŠ” ë„ë§ê°€ê³  ë¯¸ë¼ë§Œ ë‚¨ì•˜ë‹¤.',
87:'ğŸ“‰ ë§¤ìˆ˜ íƒ€ì´ë°ê³¼ ë§¤ë„ íƒ€ì´ë° ëª¨ë‘ ì¬ì ê²€ì´ í•„ìš”.',
88:'ğŸš¨ ìœ„í—˜ ì‹ í˜¸ë¥¼ ë¬´ì‹œí•œ ëŒ€ê°€ê°€ ì¢€ ì»¸ë‹¤.',
89:'ğŸŒ‹ í™”ì‚° ìœ„ì—ì„œ íˆ¬ìí•œ ëŠë‚Œì´ì—ˆì„ ê²ƒì´ë‹¤.',
90:'ğŸ˜° í•˜ìœ„ 10%... í•˜ì§€ë§Œ íŒŒì‚°í•˜ì§€ ì•Šì€ ê²Œ ì–´ë””ì•¼!',
91:'ğŸ° íˆ¬ìê°€ ì•„ë‹ˆë¼ ë„ë°•ì´ ë˜ì–´ë²„ë¦° ìˆœê°„ë“¤...',
92:'ğŸ“‰ ë‰´ìŠ¤ë¥¼ ì •ë°˜ëŒ€ë¡œ í•´ì„í•œ ê±´ ì•„ë‹Œì§€ ì ê²€í•´ë³´ì.',
93:'ğŸ§Š ì–¼ìŒ ìœ„ì—ì„œ ë¯¸ë„ëŸ¬ì§„ ëŠë‚Œì˜ íˆ¬ìì˜€ë‹¤.',
94:'ğŸŒŠ í° íŒŒë„ì— ì •ë©´ìœ¼ë¡œ ë§ì„œë‹¤ ì¢€ ë§ì´ ì –ì—ˆë‹¤.',
95:'ğŸ“¦ ê±°ì˜ ëª¨ë“  íŒë‹¨ì´ ì—‡ë‚˜ê°”ë‹¤. ì—­ë°œìƒì´ë©´ 1ë“±ì´ì—ˆì„ í…ë°!',
96:'ğŸ­ ìŠ¤ìº  ì½”ì¸ì— ë‹¹í•œ ê±´ ì•„ë‹Œì§€... í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ëŒì•„ë³´ì.',
97:'ğŸ’¸ ìì‚°ì´ ë…¹ì•„ë‚´ë ¸ë‹¤... ì¸ë²„ìŠ¤ë¡œ í–ˆìœ¼ë©´ ëŒ€ë°•ì´ì—ˆë‹¤.',
98:'ğŸš¨ íˆ¬ì ê°ì˜¥ì—ì„œ ì´ì œ ë§‰ ì¶œì†Œí•œ ëŠë‚Œ.',
99:'ğŸ†˜ êµ¬ì¡° ìš”ì²­! ëˆ„êµ°ê°€ ì´ íˆ¬ììì—ê²Œ ë„ì›€ì˜ ì†ê¸¸ì„!',
100:'ğŸ’€ ì „ì„¤ì ì¸ ì—­ëŒ€ê¸‰ ì†ì‹¤... ì˜¤íˆë ¤ ì´ ì •ë„ë©´ ì¬ëŠ¥ì´ë‹¤.'
};

function drawNormalCurve(canvas,topPct){
  const ctx=canvas.getContext('2d'),w=canvas.width,h=canvas.height;
  ctx.clearRect(0,0,w,h);
  const pad={l:35,r:15,t:10,b:28},gw=w-pad.l-pad.r,gh=h-pad.t-pad.b;
  // ì‹¤ì œ íˆ¬ìì ë¶„í¬ PDF (ì¢Œí¸í–¥ ë¹„ëŒ€ì¹­: ì†ì‹¤ ìª½ì´ ë‘êº¼ì›€)
  // skew-normal ê·¼ì‚¬: í‰ê·  -5%, ì¢Œí¸í–¥
  function realPDF(x){
    // ë¹„ëŒ€ì¹­ ë¶„í¬: ì†ì‹¤ êµ¬ê°„ì€ ë„“ê³  ë‘êº¼ì›€, ìˆ˜ìµ êµ¬ê°„ì€ ì¢ê³  ë¾°ì¡±
    const mu=-0.3,sig1=1.4,sig2=1.0; // ì¢Œì¸¡ ë” ë„“ìŒ
    const s=x<mu?sig1:sig2;
    return Math.exp(-((x-mu)*(x-mu))/(2*s*s))/(s*2.507);
  }
  const zMin=-3.8,zMax=3.2,peak=realPDF(-0.3);
  // ë°°ê²½ ê·¸ë¦¬ë“œ
  ctx.strokeStyle='#1e2a3a';ctx.lineWidth=0.5;
  for(let i=0;i<=4;i++){const y=pad.t+gh*i/4;ctx.beginPath();ctx.moveTo(pad.l,y);ctx.lineTo(pad.l+gw,y);ctx.stroke();}
  // ê³¡ì„  ì•„ë˜ ì±„ìš°ê¸° (ì „ì²´: ì–´ë‘ìš´ ìƒ‰)
  ctx.beginPath();
  for(let i=0;i<=200;i++){const z=zMin+(zMax-zMin)*i/200,x=pad.l+(i/200)*gw,y=pad.t+gh-realPDF(z)/peak*gh*.92;
    i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);}
  ctx.lineTo(pad.l+gw,pad.t+gh);ctx.lineTo(pad.l,pad.t+gh);ctx.closePath();
  ctx.fillStyle='rgba(107,114,128,0.15)';ctx.fill();
  // ë‚´ ìœ„ì¹˜ (ìƒìœ„% â†’ xì¶• ìœ„ì¹˜, 100%=ì¢Œë, 1%=ìš°ë)
  const myFrac=1-topPct/100; // 0=ì¢Œë(í•˜ìœ„), 1=ìš°ë(ìƒìœ„)
  const myZ=zMin+(zMax-zMin)*myFrac;
  // ë‚´ ìœ„ì¹˜ë³´ë‹¤ ì˜¤ë¥¸ìª½(ìƒìœ„) ì˜ì—­ ê°•ì¡°
  ctx.beginPath();
  const startI=Math.max(0,Math.floor(myFrac*200));
  for(let i=startI;i<=200;i++){const z=zMin+(zMax-zMin)*i/200,x=pad.l+(i/200)*gw,y=pad.t+gh-realPDF(z)/peak*gh*.92;
    i===startI?ctx.moveTo(x,pad.t+gh)&&ctx.lineTo(x,y):ctx.lineTo(x,y);}
  ctx.lineTo(pad.l+gw,pad.t+gh);ctx.closePath();
  const hueColor=topPct<=10?'rgba(34,197,94,0.35)':topPct<=30?'rgba(59,130,246,0.3)':topPct<=50?'rgba(245,158,11,0.25)':topPct<=70?'rgba(251,146,60,0.25)':'rgba(239,68,68,0.25)';
  ctx.fillStyle=hueColor;ctx.fill();
  // ê³¡ì„  ì„ 
  ctx.beginPath();ctx.strokeStyle='#6b7280';ctx.lineWidth=2;
  for(let i=0;i<=200;i++){const z=zMin+(zMax-zMin)*i/200,x=pad.l+(i/200)*gw,y=pad.t+gh-realPDF(z)/peak*gh*.92;
    i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);}
  ctx.stroke();
  // 0% ìˆ˜ìµë¥  ê¸°ì¤€ì„  (ì†ìµë¶„ê¸°)
  const zeroFrac=(-zMin)/(zMax-zMin);
  if(zeroFrac>0&&zeroFrac<1){
    const zx=pad.l+zeroFrac*gw;
    ctx.beginPath();ctx.strokeStyle='#374151';ctx.lineWidth=1;ctx.setLineDash([2,3]);
    ctx.moveTo(zx,pad.t);ctx.lineTo(zx,pad.t+gh);ctx.stroke();ctx.setLineDash([]);
    ctx.fillStyle='#4b5563';ctx.font='9px sans-serif';ctx.textAlign='center';
    ctx.fillText('0%',zx,pad.t+gh+10);
  }
  // ë‚´ ìœ„ì¹˜ ìˆ˜ì§ì„ 
  const myX=pad.l+myFrac*gw,myY=pad.t+gh-realPDF(myZ)/peak*gh*.92;
  const myCol=topPct<=10?'#22c55e':topPct<=30?'#3b82f6':topPct<=50?'#f59e0b':topPct<=70?'#fb923c':'#ef4444';
  ctx.beginPath();ctx.strokeStyle=myCol;
  ctx.lineWidth=2.5;ctx.setLineDash([4,3]);ctx.moveTo(myX,pad.t+gh);ctx.lineTo(myX,myY);ctx.stroke();ctx.setLineDash([]);
  // ë‚´ ìœ„ì¹˜ ì 
  ctx.beginPath();ctx.arc(myX,myY,5,0,Math.PI*2);ctx.fillStyle=myCol;ctx.fill();
  ctx.beginPath();ctx.arc(myX,myY,8,0,Math.PI*2);ctx.strokeStyle=myCol+'80';ctx.lineWidth=2;ctx.stroke();
  // "ë‚˜" ë¼ë²¨
  ctx.fillStyle='#fff';ctx.font='bold 11px sans-serif';ctx.textAlign='center';
  ctx.fillText(t('curveMe'),myX,myY-12);
  // í•˜ë‹¨ ì¶• ë¼ë²¨
  ctx.fillStyle='#4b5563';ctx.font='10px sans-serif';ctx.textAlign='center';
  const labels=[t('curveLow'),'','',t('curveMid'),'','',t('curveHigh')];
  for(let i=0;i<7;i++){ctx.fillText(labels[i],pad.l+gw*i/6,h-4);}
  // ì¢Œì¸¡ Yì¶• ë¼ë²¨
  ctx.fillStyle='#374151';ctx.font='9px sans-serif';ctx.textAlign='right';
  ctx.fillText(t('curveMany'),pad.l-5,pad.t+12);ctx.fillText(t('curveFew'),pad.l-5,pad.t+gh);
}

function endGame(reason){
  gameRunning=false;clearInterval(timerInterval);
  const tot=getTotalAsset(),pnl=(tot-START_CASH)/START_CASH*100;
  const topPct=reason==='bankrupt'?100:pnlToTopPercent(pnl);
  const rc_table=lang==='en'?RANK_COMMENTS_EN:RANK_COMMENTS;
  const comment=rc_table[topPct]||rc_table[50];
  const rankColor=topPct<=5?'#a78bfa':topPct<=10?'#22c55e':topPct<=25?'#3b82f6':topPct<=50?'#f59e0b':topPct<=75?'#fb923c':'#ef4444';
  // ì „ë©´ ê´‘ê³  ë¨¼ì € í‘œì‹œ
  showAdInterstitial(()=>{
    const ov=document.getElementById('overlay');ov.classList.remove('hidden');
    ov.querySelector('h1').textContent=reason==='bankrupt'?t('bankrupt'):reason==='finished'?t('finished'):t('endTitle');
    const rc=document.getElementById('result-card');rc.style.display='block';
    rc.innerHTML=`<div class="result-title" style="color:${pnl>=0?'var(--profit)':'var(--loss)'}">${reason==='bankrupt'?t('bankruptLabel'):'$'+tot.toFixed(0)} <span style="font-size:18px">(${pnl>=0?'+':''}${pnl.toFixed(1)}%)</span></div>
      <div class="result-rank" style="color:${rankColor}">${t('topPct')} ${topPct}<span class="pct">%</span></div>
      <div class="result-comment" style="color:${rankColor}">${comment}</div>
      <canvas class="result-curve" id="result-curve" width="420" height="160"></canvas>
      <div class="result-stats">
        ${t('finalAsset')}: $${tot.toFixed(0)} / ${t('cashLabel')}: $${cash.toFixed(0)} / ${t('coinLabel')}: $${getHV().toFixed(0)}<br>
        ${t('totalTurn')} ${Math.min(turn,MAX_TURNS)}${t('turnUnit')} / ${t('inflAccum')}: -$${inflTotal.toFixed(0)}
      </div>`;
    document.getElementById('start-btn').textContent=t('restartBtn');
    ov.querySelector('.desc').style.display='none';
    setTimeout(()=>{
      const cv=document.getElementById('result-curve');
      if(window.innerWidth<=768){
        const w=Math.min(420,rc.offsetWidth-32);
        cv.width=w;cv.height=Math.round(w*160/420);
      }
      drawNormalCurve(cv,topPct);
    },80);
  });
}

function showAdInterstitial(callback){
  const ad=document.getElementById('ad-interstitial');
  const cdEl=document.getElementById('ad-countdown');
  ad.classList.remove('hidden');
  try{(adsbygoogle=window.adsbygoogle||[]).push({});}catch(e){}
  let sec=5;
  cdEl.textContent=t('adCountdown').replace('%s',sec);
  const iv=setInterval(()=>{
    sec--;
    if(sec>0){cdEl.textContent=t('adCountdown').replace('%s',sec);}
    else{clearInterval(iv);cdEl.textContent=t('adLoading');
      setTimeout(()=>{ad.classList.add('hidden');callback();},600);}
  },1000);
}

function showSysNews(msg){
  const el=document.getElementById('sys-news');el.textContent=msg;el.classList.remove('hidden');
  clearTimeout(el._t);el._t=setTimeout(()=>el.classList.add('hidden'),4000);
}

document.getElementById('start-btn').addEventListener('click',()=>startGame());

// â•â•â• ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” í† ê¸€ â•â•â•
function toggleSidebar(){
  const sb=document.querySelector('.sidebar'),ov=document.getElementById('sidebar-overlay');
  sb.classList.toggle('open');ov.classList.toggle('show');
}

// â•â•â• ëª¨ë°”ì¼ ì£¼ë¬¸ íŒ¨ë„ í† ê¸€ â•â•â•
function toggleOrder(sym){
  const row=document.getElementById(`order-${sym}`);
  const btn=document.getElementById(`toggle-${sym}`);
  if(row.classList.contains('collapsed')){
    // ë‹¤ë¥¸ ì—´ë¦° íŒ¨ë„ ëª¨ë‘ ë‹«ê¸°
    document.querySelectorAll('.order-row:not(.collapsed)').forEach(r=>{
      if(window.innerWidth<=768&&r.id!==`order-${sym}`){
        r.classList.add('collapsed');
        const s=r.id.replace('order-','');
        const tb=document.getElementById(`toggle-${s}`);
        if(tb){const ov=orders[s];tb.textContent=ov?(ov>0?`${t('buy')}$${ov}`:`${t('sell')}$${Math.abs(ov)}`):`â–¼ ${lang==='en'?'Trade':'ì£¼ë¬¸'}`;}
      }
    });
    row.classList.remove('collapsed');
    btn.textContent=`â–² ${lang==='en'?'Close':'ë‹«ê¸°'}`;
  }else{
    row.classList.add('collapsed');
    const ov=orders[sym];
    btn.textContent=ov?(ov>0?`${t('buy')}$${ov}`:`${t('sell')}$${Math.abs(ov)}`):`â–¼ ${lang==='en'?'Trade':'ì£¼ë¬¸'}`;
  }
}

// ê²°ê³¼ ìº”ë²„ìŠ¤ ëª¨ë°”ì¼ ë¦¬ì‚¬ì´ì¦ˆ
window.addEventListener('resize',()=>{
  const cv=document.getElementById('result-curve');
  if(cv&&cv.parentElement&&cv.style.display!=='none'){
    const w=Math.min(420,cv.parentElement.offsetWidth-32);
    cv.width=w;cv.height=Math.round(w*160/420);
  }
});

// â•â•â• ì–¸ì–´ ì „í™˜ â•â•â•
function switchLang(){
  lang=lang==='ko'?'en':'ko';
  document.getElementById('lang-ko').className=lang==='ko'?'active':'';
  document.getElementById('lang-en').className=lang==='en'?'active':'';
  document.documentElement.lang=lang;
  updateStaticUI();
  if(gameRunning){
    // ë‰´ìŠ¤ ë‹¤ì‹œ ë Œë”(ê¸°ì¡´ ë‰´ìŠ¤ ì¬ë²ˆì—­ì€ ë³µì¡í•˜ë¯€ë¡œ ë¼ë²¨ë§Œ ê°±ì‹ )
    renderNewsPanel();buildCoinCards();updateHeader();updateTurnGauge();updatePS();
  }
}
function updateStaticUI(){
  document.getElementById('logo-text').textContent=t('logo');
  // í—¤ë” stat labels
  const labels=document.querySelectorAll('.stat-label');
  const lkeys=['cash','coinAsset','totalAsset','pnl'];
  labels.forEach((el,i)=>{if(lkeys[i])el.textContent=t(lkeys[i]);});
  document.querySelector('.timer-label').textContent=t('timeLeft');
  // ì‚¬ì´ë“œë°”
  const sbTitles=document.querySelectorAll('.sb-title');
  const sbKeys=['turnProgress','incomeLevel','newsTitle'];
  sbTitles.forEach((el,i)=>{if(sbKeys[i])el.textContent=T[lang][sbKeys[i]]||el.textContent;});
  // ì†Œë“ ticks
  const ticks=document.querySelectorAll('.income-ticks span');
  const gt=t('gradeTicks');
  ticks.forEach((el,i)=>{if(gt[i])el.textContent=gt[i];});
  // ì˜¤ë²„ë ˆì´
  const ov=document.getElementById('overlay');
  ov.querySelector('h1').textContent=t('gameTitle');
  ov.querySelector('.desc').innerHTML=t('gameDesc');
  const startBtn=document.getElementById('start-btn');
  if(startBtn.textContent!==t('restartBtn'))startBtn.textContent=t('startBtn');
  // í•˜ë‹¨ ë°”
  document.querySelector('.submit-btn').innerHTML=t('submit');
  document.querySelector('.reset-btn').textContent=t('reset');
  // ê´‘ê³ 
  document.querySelector('.ad-label').textContent=lang==='en'?'AD':'ê´‘ê³ ';
}
</script>
</body>
</html>
